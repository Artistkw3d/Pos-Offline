<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="POS">
    <meta name="theme-color" content="#667eea">
    <link rel="manifest" href="manifest.json">
    <title>ูุธุงู ููุงุท ุงูุจูุน</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- License Warning Banner -->
    <div id="licenseWarningBanner" style="display:none; position:fixed; top:0; left:0; right:0; z-index:99998; padding:10px 20px; text-align:center; font-size:14px; font-weight:bold; direction:rtl; cursor:pointer;" onclick="forceLicenseRefresh()">
        <span id="licenseWarningText"></span>
        <button onclick="event.stopPropagation(); forceLicenseRefresh();" style="margin-right:15px; padding:4px 16px; border:none; border-radius:4px; cursor:pointer; font-size:13px; background:#fff; color:#333;">ุชุฌุฏูุฏ ุงูุชุฑุฎูุต</button>
    </div>

    <!-- License Expired Overlay -->
    <div id="licenseExpiredOverlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.92); z-index:100000; justify-content:center; align-items:center; flex-direction:column;">
        <div style="text-align:center; color:#fff; padding:40px; max-width:500px;">
            <div style="font-size:80px; margin-bottom:20px;">โ๏ธ</div>
            <h1 id="licenseExpiredTitle" style="font-size:26px; margin-bottom:15px; color:#ff6b6b;">ุงูุชูุช ุตูุงุญูุฉ ุงูุชุฑุฎูุต</h1>
            <p id="licenseExpiredMessage" style="font-size:16px; margin-bottom:25px; color:#ccc; line-height:1.6;"></p>
            <button onclick="attemptLicenseRenewal()" style="padding:14px 40px; font-size:16px; border-radius:8px; border:none; background:#3b82f6; color:#fff; cursor:pointer; margin-bottom:12px;">ุชุฌุฏูุฏ ุงูุชุฑุฎูุต</button>
            <p id="licenseRenewStatus" style="font-size:13px; color:#999; min-height:20px; margin-top:10px;"></p>
        </div>
    </div>

    <!-- Shift Lock Overlay -->
    <div id="shiftLockOverlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:99999; justify-content:center; align-items:center; flex-direction:column;">
        <div style="text-align:center; color:#fff; padding:40px;">
            <div style="font-size:80px; margin-bottom:20px;">๐</div>
            <h1 style="font-size:28px; margin-bottom:15px; color:#ff6b6b;">ุงูุชูู ููุช ุงูุดูุช</h1>
            <p id="shiftLockMessage" style="font-size:18px; margin-bottom:10px; color:#ccc;"></p>
            <p style="font-size:14px; color:#999; margin-bottom:30px;">ุชู ููู ุงููุธุงู ุชููุงุฆูุงู. ูุฑุฌู ุงูุชูุงุตู ูุน ุงููุฏูุฑ ุฃู ุชุณุฌูู ุงูุฎุฑูุฌ.</p>
            <button onclick="logoutFromShiftLock()" style="padding:12px 40px; font-size:16px; border-radius:8px; border:none; background:#e74c3c; color:#fff; cursor:pointer;">ุชุณุฌูู ุฎุฑูุฌ</button>
        </div>
    </div>

    <!-- Server Setup (first-time) -->
    <div class="login-overlay" id="serverSetupOverlay" style="display:none;">
        <div class="login-box" style="max-width: 440px;">
            <div class="login-logo"><img src="icon-192.png" style="width: 80px; height: 80px; border-radius: 16px; object-fit: cover;"></div>
            <h1 class="login-title">ุฅุนุฏุงุฏ ุงููุธุงู</h1>
            <p style="text-align:center; color:#666; margin-bottom:18px; font-size:14px;">ูู ุจุฑุจุท ุงููุธุงู ุจุงูุฎุงุฏู ูุชูุนูู ุงููุชุฌุฑ</p>
            <div class="login-form-group">
                <label>ุนููุงู ุงูุฎุงุฏู (Server URL)</label>
                <input type="text" id="setupServerUrl" placeholder="https://my-pos.org" style="direction:ltr; text-align:center; font-size:16px;">
            </div>
            <div class="login-form-group">
                <label>ูุนุฑู ุงููุชุฌุฑ (Tenant ID)</label>
                <input type="text" id="setupTenantSlug" placeholder="my-store" style="direction:ltr; text-align:center; font-size:16px;">
            </div>
            <div id="setupTestResult" style="min-height:28px; text-align:center; font-size:13px; margin-bottom:8px;"></div>
            <div id="setupSubscriptionInfo" style="display:none; background:#f0fdf4; border:1px solid #bbf7d0; border-radius:8px; padding:10px; margin-bottom:12px; font-size:13px; text-align:right;"></div>
            <button type="button" class="login-btn" style="background:#3b82f6; margin-bottom:10px;" onclick="testSetupConnection()">ุงุฎุชุจุงุฑ ุงูุงุชุตุงู</button>
            <button type="button" class="login-btn" id="setupSaveBtn" onclick="saveServerSetup()" style="opacity:0.5; pointer-events:none;">ุญูุธ ูุงููุชุงุจุนุฉ</button>
            <div id="setupSkipContainer" style="text-align:center; margin-top:14px; display:none;">
                <a href="#" onclick="skipServerSetup(); return false;" style="color:#999; font-size:13px; text-decoration:underline;">ุชุฎุทู (ุงุณุชุฎุฏุงู ูุญูู ููุท)</a>
            </div>
        </div>
    </div>

    <!-- Login -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-box">
            <div class="login-logo"><img src="icon-192.png" style="width: 100px; height: 100px; border-radius: 20px; object-fit: cover;"></div>
            <h1 class="login-title">ูุธุงู ููุงุท ุงูุจูุน</h1>
            <div id="loginVersion" style="font-size: 12px; color: #333; margin-top: -5px; margin-bottom: 8px; font-weight: 500;"></div>
            <!-- ุงุฎุชูุงุฑ ูุถุน ุงูุนุฑุถ -->
            <div class="view-mode-selector" id="viewModeSelector">
                <div class="view-mode-label">ุงุฎุชุฑ ูุถุน ุงูุนุฑุถ</div>
                <div class="view-mode-buttons">
                    <button type="button" class="view-mode-btn active" id="desktopModeBtn" onclick="selectViewMode('desktop')">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>
                        <span>ููุจููุชุฑ</span>
                    </button>
                    <button type="button" class="view-mode-btn" id="mobileModeBtn" onclick="selectViewMode('mobile')">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect><line x1="12" y1="18" x2="12.01" y2="18"></line></svg>
                        <span>ููุจุงูู / ุขูุจุงุฏ</span>
                    </button>
                </div>
            </div>
            <form class="login-form" id="loginForm">
                <div class="login-form-group">
                    <label>๐ข ูุนุฑู ุงููุชุฌุฑ</label>
                    <input type="text" id="loginTenantSlug" placeholder="ุฃุฏุฎู ูุนุฑู ุงููุชุฌุฑ" style="direction: ltr; text-align: center;">
                </div>
                <div class="login-form-group">
                    <label>ุงุณู ุงููุณุชุฎุฏู</label>
                    <input type="text" id="loginUsername" required>
                </div>
                <div class="login-form-group">
                    <label>ูููุฉ ุงููุฑูุฑ</label>
                    <input type="password" id="loginPassword" required>
                </div>
                <button type="submit" class="login-btn">ุฏุฎูู</button>
            </form>
            <div style="text-align:center; margin-top:14px;">
                <a href="#" onclick="openServerSetup(); return false;" style="color:#999; font-size:13px; text-decoration:underline;">โ๏ธ ุฅุนุฏุงุฏ ุงูุฎุงุฏู ูุงููุฒุงููุฉ</a>
            </div>
        </div>
    </div>

    <!-- Super Admin Dashboard -->
    <div id="superAdminDashboard" style="display: none;">
        <div style="background: linear-gradient(135deg, #1e293b, #334155); color: white; padding: 15px 25px; display: flex; justify-content: space-between; align-items: center;">
            <div style="display: flex; align-items: center; gap: 12px;">
                <span style="font-size: 24px;">๐</span>
                <h2 style="margin: 0; font-size: 18px;">ููุญุฉ ุชุญูู ุงููุฏูุฑ ุงูุฃุนูู</h2>
            </div>
            <div style="display: flex; align-items: center; gap: 12px;">
                <span id="saUserInfo" style="font-size: 13px; opacity: 0.8;"></span>
                <button onclick="showSuperAdminSettings()" style="background: #8b5cf6; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer;">โ๏ธ ุงูุฅุนุฏุงุฏุงุช</button>
                <button onclick="logoutSuperAdmin()" style="background: #ef4444; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer;">๐ช ุฎุฑูุฌ</button>
            </div>
        </div>
        <div style="padding: 25px; max-width: 1200px; margin: 0 auto;">
            <!-- ุฅุญุตุงุฆูุงุช ุนุงูุฉ -->
            <div id="saStatsContainer" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;"></div>

            <!-- ุฅุถุงูุฉ ูุณุชุฃุฌุฑ -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                <h3 style="margin: 0;">๐ข ุงููุชุงุฌุฑ (ุงููุณุชุฃุฌุฑูู)</h3>
                <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                    <button onclick="superAdminBackupAll()" style="background: linear-gradient(135deg, #10b981, #059669); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 14px;">๐พ ูุณุฎ ุงุญุชูุงุทู ูููู</button>
                    <button onclick="showAddTenant()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 14px;">โ ุฅุถุงูุฉ ูุชุฌุฑ ุฌุฏูุฏ</button>
                </div>
            </div>

            <!-- ุฌุฏูู ุงููุณุชุฃุฌุฑูู -->
            <div id="tenantsTableContainer" style="background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden;"></div>
        </div>
    </div>

    <!-- Add/Edit Tenant Modal -->
    <div class="modal" id="addTenantModal">
        <div class="modal-content" style="max-width: 550px;">
            <div class="modal-header">
                <h2 id="tenantModalTitle">โ ุฅุถุงูุฉ ูุชุฌุฑ ุฌุฏูุฏ</h2>
                <button onclick="document.getElementById('addTenantModal').classList.remove('active')" class="close-btn">&times;</button>
            </div>
            <form id="tenantForm">
                <input type="hidden" id="tenantEditId">
                <div class="form-group">
                    <label>ุงุณู ุงููุชุฌุฑ:</label>
                    <input type="text" id="tenantName" required placeholder="ูุซุงู: ูุทุนู ุงูุณูุงู">
                </div>
                <div class="form-group" id="tenantSlugGroup">
                    <label>ูุนุฑู ุงููุชุฌุฑ (ุจุงูุฅูุฌููุฒูุฉ):</label>
                    <input type="text" id="tenantSlug" required placeholder="ูุซุงู: al-salam" pattern="[a-zA-Z0-9_-]+" style="direction: ltr;">
                    <small style="color: #64748b;">ูุณุชุฎุฏู ููุชุนุฑูู - ุฃุญุฑู ุฅูุฌููุฒูุฉ ูุฃุฑูุงู ููุท</small>
                </div>
                <div class="form-group">
                    <label>ุงุณู ุงููุงูู:</label>
                    <input type="text" id="tenantOwnerName" required placeholder="ุงุณู ุตุงุญุจ ุงููุชุฌุฑ">
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div class="form-group">
                        <label>ุงูุจุฑูุฏ:</label>
                        <input type="email" id="tenantOwnerEmail" placeholder="email@example.com" style="direction: ltr;">
                    </div>
                    <div class="form-group">
                        <label>ุงููุงุชู:</label>
                        <input type="text" id="tenantOwnerPhone" placeholder="9XXXXXXX">
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;" id="tenantAdminFields">
                    <div class="form-group">
                        <label>ุงุณู ูุณุชุฎุฏู ุงูุฃุฏูู:</label>
                        <input type="text" id="tenantAdminUsername" value="admin" style="direction: ltr;">
                    </div>
                    <div class="form-group">
                        <label>ูููุฉ ูุฑูุฑ ุงูุฃุฏูู:</label>
                        <input type="text" id="tenantAdminPassword" value="admin123" style="direction: ltr;">
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                    <div class="form-group">
                        <label>ุงูุฎุทุฉ:</label>
                        <select id="tenantPlan">
                            <option value="basic">ุฃุณุงุณูุฉ</option>
                            <option value="premium">ูุชูุฏูุฉ</option>
                            <option value="enterprise">ูุคุณุณุงุช</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ุฃูุตู ูุณุชุฎุฏููู:</label>
                        <input type="number" id="tenantMaxUsers" value="5" min="1">
                    </div>
                    <div class="form-group">
                        <label>ุฃูุตู ูุฑูุน:</label>
                        <input type="number" id="tenantMaxBranches" value="3" min="1">
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                    <div class="form-group">
                        <label>๐ฐ ูููุฉ ุงูุงุดุชุฑุงู (ุฏ.ู):</label>
                        <input type="number" id="tenantSubAmount" value="0" min="0" step="0.001">
                    </div>
                    <div class="form-group">
                        <label>๐ ูุฏุฉ ุงูุงุดุชุฑุงู (ููู):</label>
                        <input type="number" id="tenantSubPeriod" value="30" min="1">
                    </div>
                    <div class="form-group">
                        <label>๐ ูุถุน ุงูุชุดุบูู:</label>
                        <select id="tenantMode">
                            <option value="online">ุฃูููุงูู (Online)</option>
                            <option value="offline">ุฃูููุงูู (Offline)</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn" style="width: 100%; padding: 12px;">๐พ ุญูุธ</button>
            </form>
        </div>
    </div>

    <!-- Tenant Stats Modal -->
    <div class="modal" id="tenantStatsModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 id="tenantStatsTitle">๐ ุฅุญุตุงุฆูุงุช ุงููุชุฌุฑ</h2>
                <button onclick="document.getElementById('tenantStatsModal').classList.remove('active')" class="close-btn">&times;</button>
            </div>
            <div id="tenantStatsContent" style="padding: 15px;"></div>
        </div>
    </div>

    <!-- Subscription Modal -->
    <div class="modal" id="subscriptionModal">
        <div class="modal-content" style="max-width: 650px;">
            <div class="modal-header">
                <h2 id="subscriptionModalTitle">๐ณ ุฅุฏุงุฑุฉ ุงูุงุดุชุฑุงู</h2>
                <button onclick="document.getElementById('subscriptionModal').classList.remove('active')" class="close-btn">&times;</button>
            </div>
            <div style="padding: 15px;">
                <!-- ูุนูููุงุช ุงูุงุดุชุฑุงู ุงูุญุงูู -->
                <div id="subscriptionInfo" style="margin-bottom: 20px;"></div>

                <!-- ุฅูุดุงุก ูุงุชูุฑุฉ ุงุดุชุฑุงู ุฌุฏูุฏุฉ -->
                <div style="background: #f0fdf4; padding: 15px; border-radius: 10px; border: 2px solid #86efac; margin-bottom: 20px;">
                    <h4 style="margin: 0 0 12px 0; color: #059669;">โ ุชุฌุฏูุฏ / ุฅูุดุงุก ูุงุชูุฑุฉ ุงุดุชุฑุงู</h4>
                    <form id="subscriptionForm">
                        <input type="hidden" id="subTenantId">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div class="form-group">
                                <label>ุงููุจูุบ (ุฏ.ู):</label>
                                <input type="number" id="subAmount" min="0.001" step="0.001" required>
                            </div>
                            <div class="form-group">
                                <label>ุงููุฏุฉ (ููู):</label>
                                <input type="number" id="subPeriodDays" min="1" value="30" required>
                            </div>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div class="form-group">
                                <label>ุทุฑููุฉ ุงูุฏูุน:</label>
                                <select id="subPaymentMethod">
                                    <option value="cash">๐ต ููุฏุงู</option>
                                    <option value="knet">๐ณ ูู ูุช</option>
                                    <option value="bank">๐ฆ ุชุญููู ุจููู</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>ููุงุญุธุงุช:</label>
                                <input type="text" id="subNotes" placeholder="ุงุฎุชูุงุฑู">
                            </div>
                        </div>
                        <button type="submit" class="btn" style="width: 100%; padding: 10px; background: linear-gradient(135deg, #10b981, #059669); color: white;">๐ฐ ุฅุตุฏุงุฑ ูุงุชูุฑุฉ ูุชุฌุฏูุฏ ุงูุงุดุชุฑุงู</button>
                    </form>
                </div>

                <!-- ุณุฌู ุงูููุงุชูุฑ -->
                <h4 style="margin: 0 0 10px 0;">๐ ุณุฌู ููุงุชูุฑ ุงูุงุดุชุฑุงู</h4>
                <div id="subscriptionInvoicesList"></div>
            </div>
        </div>
    </div>

    <!-- Main -->
    <div class="container" id="mainContainer" style="display: none;">
        <div class="header">
            <div class="header-left">
                <button class="header-btn active" onclick="showTab('pos')" data-tab="pos">๐ณ POS</button>
                <button class="header-btn" onclick="showTab('products')" data-tab="products">๐ฆ ุงูููุชุฌุงุช</button>
                <button class="header-btn" onclick="showTab('inventory')" data-tab="inventory">๐ ุงููุฎุฒูู</button>
                <button class="header-btn" onclick="showTab('invoices')" data-tab="invoices">๐งพ ุงูููุงุชูุฑ</button>
                <button class="header-btn" onclick="showTab('returns')" data-tab="returns" id="returnsBtn" style="display: none;">๐ ุงููุฑุชุฌุนุงุช</button>
                <button class="header-btn" onclick="showTab('customers')" data-tab="customers">๐ฅ ุงูุนููุงุก</button>
                <button class="header-btn" onclick="showTab('reports')" data-tab="reports">๐ ุงูุชูุงุฑูุฑ</button>
                <button class="header-btn" onclick="showTab('expenses')" data-tab="expenses" id="expensesBtn" style="display: none;">๐ฐ ุงูุชูุงููู</button>
                <button class="header-btn" onclick="showTab('advancedreports')" data-tab="advancedreports" id="advancedReportsBtn" style="display: none;">๐ ุชูุงุฑูุฑ ูุชูุฏูุฉ</button>
                <button class="header-btn" onclick="showTab('systemlogs')" data-tab="systemlogs" id="systemLogsBtn" style="display: none;">๐ ุณุฌู ุงููุธุงู</button>
                <button class="header-btn" onclick="showTab('coupons')" data-tab="coupons" id="couponsBtn" style="display: none;">๐๏ธ ุงูููุจููุงุช</button>
                <button class="header-btn" onclick="showTab('suppliers')" data-tab="suppliers" id="suppliersBtn" style="display: none;">๐ญ ุงูููุฑุฏูู</button>
                <button class="header-btn" onclick="showTab('tables')" data-tab="tables" id="tablesBtn" style="display: none;">๐ฝ๏ธ ุงูุทุงููุงุช</button>
                <button class="header-btn" onclick="showTab('accounting')" data-tab="accounting">๐ฐ ุงููุญุงุณุจุฉ</button>
                <button class="header-btn" onclick="showTab('dcf')" data-tab="dcf" id="dcfBtn" style="display: none;">๐ ุชูููู DCF</button>
                <button class="header-btn" onclick="showTab('users')" data-tab="users" id="usersBtn" style="display: none;">๐ฅ ุงููุณุชุฎุฏููู</button>
                <button class="header-btn" onclick="showTab('branches')" data-tab="branches" id="branchesBtn" style="display: none;">๐ข ุงููุฑูุน</button>
                <button class="header-btn" onclick="showTab('attendance')" data-tab="attendance" id="attendanceBtn" style="display: none;">โฐ ุงูุญุถูุฑ</button>
                <button class="header-btn" onclick="showTab('settings')" data-tab="settings" id="settingsBtn" style="display: none;">โ๏ธ ุฅุนุฏุงุฏุงุช</button>
                <button class="header-btn" onclick="showTab('backup')" data-tab="backup" id="backupBtn" style="display: none;">๐พ ุงููุณุฎ ุงูุงุญุชูุงุทู</button>
                <button class="header-btn" onclick="showTab('xbrl')" data-tab="xbrl" id="xbrlBtn" style="display: none;">๐ XBRL</button>
                <button class="header-btn" onclick="showTab('admindashboard')" data-tab="admindashboard" id="adminDashboardBtn" style="display: none;">๐ ุดุงุดุฉ ุงูุฃุฏูู</button>
                <button class="header-btn" onclick="showTab('transfers')" data-tab="transfers" id="transfersBtn" style="display: none;">๐ ุทูุจุงุช ุงูููู</button>
                <button class="header-btn" onclick="showTab('subscriptions')" data-tab="subscriptions" id="subscriptionsBtn" style="display: none;">๐ณ ุงูุงุดุชุฑุงูุงุช</button>
            </div>
            <div class="header-center">
                <h1>๐๏ธ ูุธุงู ููุงุท ุงูุจูุน</h1>
                <div id="headerVersion" style="font-size: 12px; color: #000; margin-top: 2px; font-weight: 500;"></div>
                <div id="datetime" style="font-size: 14px; color: #ffffff; margin-top: 5px;"></div>
            </div>
            <div class="header-right">
                <span class="user-info" id="userInfo"></span>
                <button class="logout-btn" id="logoutBtn" onclick="logout()">ุฎุฑูุฌ</button>
            </div>
        </div>

        <!-- POS Tab -->
        <div class="tab-content active" id="posTab">
            <div class="main-content">
                <!-- ุงูููุชุฌุงุช ุนูู ุงููููู -->
                <div class="products-section">
                    <div class="search-box">
                        <input type="text" id="searchInput" placeholder="๐ ุงุจุญุซ..." onkeyup="searchProducts()">
                    </div>
                    <div style="padding: 0 10px 10px; display: flex; gap: 5px;">
                        <input type="text" id="barcodeInput" placeholder="๐ ูุณุญ ุงูุจุงุฑููุฏ..." style="flex: 1; padding: 10px; border: 2px solid #eab308; border-radius: 8px; font-size: 14px; font-weight: bold; background: #fefce8;" oninput="onBarcodeInput(this.value)">
                    </div>
                    <div class="products-grid" id="productsGrid"></div>
                </div>

                <!-- ุงูุณูุฉ ุนูู ุงููุณุงุฑ -->
                <div class="cart-section">
                    <div class="cart-header"><h2>๐ ุงูุณูุฉ</h2><button class="clear-cart-btn" onclick="clearCart()">ูุณุญ</button></div>
                    
                    <!-- ูุงุฆูุฉ ุงูููุชุฌุงุช ุงูุจุณูุทุฉ -->
                    <div class="cart-items" id="cartItems">
                        <div class="empty-cart"><div class="empty-cart-icon">๐</div><p>ุงูุณูุฉ ูุงุฑุบุฉ</p></div>
                    </div>

                    <!-- ูุนูููุงุช ุงูุนููู -->
                    <div class="customer-section">
                        <h3>๐ค ูุนูููุงุช ุงูุนููู</h3>

                        <div style="position: relative;">
                            <input type="text" id="customerSearchInput" placeholder="๐ ุงุจุญุซ ุจุงูุงุณู ุฃู ุฑูู ุงููุงุชู..."
                                autocomplete="off"
                                style="width: 100%; padding: 10px 40px 10px 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px; margin-bottom: 0;"
                                oninput="searchCustomerInPOS(this.value)"
                                onfocus="searchCustomerInPOS(this.value)">
                            <button onclick="showAddCustomerFromPOS()" title="ุฅุถุงูุฉ ุนููู ุฌุฏูุฏ"
                                style="position: absolute; left: 6px; top: 6px; background: #28a745; color: white; border: none; width: 30px; height: 30px; border-radius: 6px; cursor: pointer; font-size: 16px; display: flex; align-items: center; justify-content: center;">+</button>
                            <div id="customerSearchResults" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: white; border: 2px solid #667eea; border-top: none; border-radius: 0 0 8px 8px; max-height: 200px; overflow-y: auto; z-index: 50; box-shadow: 0 4px 12px rgba(0,0,0,0.15);"></div>
                        </div>

                        <input type="hidden" id="selectedCustomerId">
                        <input type="hidden" id="customerName">
                        <input type="hidden" id="customerPhone">
                        <input type="hidden" id="customerAddress">
                        
                        <div id="customerDetails" style="display: none; background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 10px;">
                            <div style="margin-bottom: 8px;">
                                <strong>๐ ุงูุงุณู:</strong> <span id="displayCustomerName"></span>
                            </div>
                            <div style="margin-bottom: 8px;">
                                <strong>๐ ุงููุงุชู:</strong> <span id="displayCustomerPhone"></span>
                            </div>
                            <div style="margin-bottom: 8px;">
                                <strong>๐ ุงูุนููุงู:</strong> <span id="displayCustomerAddress"></span>
                            </div>
                            <button onclick="clearCustomerSelection()" style="margin-top: 10px; padding: 6px 12px; background: #dc3545; color: white; border: none; border-radius: 6px; cursor: pointer;">
                                โ๏ธ ูุณุญ ุงูุงุฎุชูุงุฑ
                            </button>
                        </div>
                        
                        <!-- ููุงุท ุงูููุงุก -->
                        <div id="loyaltySection" style="display: none; background: #f0f9ff; padding: 12px; border-radius: 8px; margin-top: 10px; border: 2px solid #0ea5e9;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span style="font-weight: bold; color: #0369a1;">๐ ููุงุท ุงูููุงุก</span>
                                <span style="font-size: 18px; font-weight: bold; color: #0c4a6e;" id="customerLoyaltyPoints">0</span>
                            </div>
                            <div style="font-size: 11px; color: #64748b; margin-bottom: 8px;">
                                ๐ฐ ุณูุฑุจุญ: <span id="pointsToEarn" style="font-weight: bold; color: #38a169;">0</span> ููุทุฉ
                            </div>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="pointsToRedeem" placeholder="ุงุณุชุฎุฏู ููุงุท" min="0" step="1" style="flex: 1; padding: 6px; font-size: 12px;" oninput="calculateLoyaltyDiscount()">
                                <button onclick="applyMaxPoints()" class="btn-sm" style="background: #f59e0b; padding: 6px 10px; font-size: 11px;">ุงุณุชุฎุฏู ุงููู</button>
                            </div>
                            <div id="loyaltyHint" style="font-size: 10px; color: #94a3b8; margin-top: 5px;">
                                ๐ก ูู ููุทุฉ = <span id="pointValueHint">0.100</span> ุฏ.ู ุฎุตู
                            </div>
                        </div>
                    </div>

                    <!-- ููุจูู ุงูุฎุตู -->
                    <div id="couponSection" style="background: #fefce8; padding: 12px; border-radius: 8px; margin-bottom: 10px; border: 2px solid #eab308;">
                        <div style="font-weight: bold; color: #854d0e; margin-bottom: 8px;">๐๏ธ ููุจูู ุฎุตู</div>
                        <div style="display: flex; gap: 5px;">
                            <input type="text" id="couponCodeInput" placeholder="ุฃุฏุฎู ููุฏ ุงูููุจูู" style="flex: 1; padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px; text-transform: uppercase;">
                            <button onclick="applyCouponCode()" class="btn-sm" style="background: #eab308; color: #fff; padding: 8px 14px; white-space: nowrap;">ุชุทุจูู</button>
                        </div>
                        <div id="couponResult" style="display: none; margin-top: 8px; padding: 8px; border-radius: 6px;"></div>
                    </div>

                    <!-- ุทุงููุฉ ุงููุทุนู -->
                    <div id="tableSelectionSection" style="display: none; background: #faf5ff; padding: 12px; border-radius: 8px; margin-bottom: 10px; border: 2px solid #8b5cf6;">
                        <div style="font-weight: bold; color: #6d28d9; margin-bottom: 8px;">๐ฝ๏ธ ุทุงููุฉ ุงููุทุนู</div>
                        <select id="selectedTableId" style="width: 100%; padding: 8px; border: 2px solid #c4b5fd; border-radius: 6px;">
                            <option value="">-- ุจุฏูู ุทุงููุฉ --</option>
                        </select>
                    </div>

                    <!-- ุงูุฏูุน -->
                    <div class="payment-section">
                        <h3>๐ณ ุงูุฏูุน</h3>
                        <div id="paymentMethodsList">
                            <div class="payment-entry" data-index="0" style="display: flex; gap: 5px; align-items: center; margin-bottom: 8px;">
                                <select class="pm-method" onchange="togglePaymentTxn(this)" style="flex: 1; padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px;">
                                    <option value="cash">๐ต ููุฏุงู</option>
                                    <option value="knet">๐ณ ูู ูุช</option>
                                    <option value="visa">๐ณ ููุฒุง</option>
                                    <option value="other">๐ฐ ุฃุฎุฑู</option>
                                </select>
                                <input type="number" class="pm-amount" placeholder="ุงููุจูุบ" step="0.001" min="0" style="width: 100px; padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px;">
                                <input type="text" class="pm-txn" placeholder="ุฑูู ุงูุนูููุฉ" style="display: none; width: 110px; padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px;">
                            </div>
                        </div>
                        <button onclick="addPaymentMethod()" type="button" style="background: #38a169; color: white; border: none; padding: 6px 14px; border-radius: 6px; cursor: pointer; font-size: 13px; margin-top: 4px;">โ ุนูููุฉ ุฅุถุงููุฉ</button>
                        <!-- Hidden fields for backward compatibility -->
                        <input type="hidden" id="paymentMethod" value="cash">
                        <input type="hidden" id="transactionNumber" value="">
                    </div>

                    <!-- ุงูููุฎุต -->
                    <div class="invoice-summary">
                        <div class="summary-row"><span>ุงููุฌููุน:</span><span id="subtotal">0.000 ุฏ.ู</span></div>
                        <div class="summary-row">
                            <span>ุงูุฎุตู:</span>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="discountInput" value="0" min="0" step="0.001" style="width: 80px;" onchange="updateTotals()">
                                <select id="discountType" onchange="updateTotals()" style="width: 70px; padding: 5px;">
                                    <option value="amount">ุฏ.ู</option>
                                    <option value="percent">%</option>
                                </select>
                            </div>
                        </div>
                        <div class="summary-row" id="loyaltyDiscountRow" style="display: none;">
                            <span>๐ ุฎุตู ุงูููุงุก:</span>
                            <span id="loyaltyDiscountAmount" style="color: #38a169; font-weight: bold;">0.000 ุฏ.ู</span>
                        </div>
                        <div class="summary-row" id="subscriptionRedeemRow" style="display: none;">
                            <span>๐ณ ุงุดุชุฑุงู ูุนูุงู:</span>
                            <button onclick="showRedeemSubscription()" style="padding: 5px 12px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: bold;">๐ฆ ุงุณุชูุงู ููุชุฌุงุช</button>
                        </div>
                        <div class="summary-row" id="couponDiscountRow" style="display: none;">
                            <span>๐๏ธ ุฎุตู ุงูููุจูู:</span>
                            <span id="couponDiscountDisplay" style="color: #eab308; font-weight: bold;">0.000 ุฏ.ู</span>
                        </div>
                        <div class="summary-row"><span>ุฑุณูู ุงูุชูุตูู:</span><input type="number" id="deliveryFee" value="0" min="0" step="0.001" style="width: 100px;" onchange="updateTotals()"></div>
                        <div class="summary-row total"><span>ุงูุฅุฌูุงูู:</span><span id="total">0.000 ุฏ.ู</span></div>
                    </div>

                    <!-- ููุงุญุธุงุช ุงูุทูุจ -->
                    <div style="margin: 10px 0;">
                        <textarea id="orderNotes" placeholder="๐ ููุงุญุธุงุช ุงูุทูุจ (ุงุฎุชูุงุฑู)..." rows="2" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px; resize: vertical; font-family: inherit;"></textarea>
                    </div>

                    <!-- ุงูุฒุฑ -->
                    <div class="action-buttons">
                        <button class="complete-btn" onclick="completeSale()">โ ุฅุชูุงู</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Products Tab -->
        <div class="tab-content" id="productsTab" style="display: none;">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                    <h2>๐ฆ ุงูููุชุฌุงุช</h2>
                    <button class="add-btn" onclick="showAddProduct()">โ ุฅุถุงูุฉ</button>
                </div>
                
                <!-- ุจุญุซ ูุชูุฏู -->
                <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                    <h3 style="margin: 0 0 15px; font-size: 16px;">๐ ุจุญุซ ูุชูุฏู</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                        <input type="text" id="searchProductName" placeholder="ุงุณู ุงูููุชุฌ..." onkeyup="advancedSearchProducts()" style="padding: 8px; border: 2px solid #cbd5e0; border-radius: 6px;">
                        <input type="text" id="searchProductBarcode" placeholder="ุงูุจุงุฑููุฏ..." onkeyup="advancedSearchProducts()" style="padding: 8px; border: 2px solid #cbd5e0; border-radius: 6px;">
                        <select id="searchProductCategory" onchange="advancedSearchProducts()" style="padding: 8px; border: 2px solid #cbd5e0; border-radius: 6px;">
                            <option value="">ูู ุงููุฆุงุช</option>
                        </select>
                        <input type="number" id="searchPriceMin" placeholder="ุงูุณุนุฑ ูู..." onkeyup="advancedSearchProducts()" style="padding: 8px; border: 2px solid #cbd5e0; border-radius: 6px;">
                        <input type="number" id="searchPriceMax" placeholder="ุงูุณุนุฑ ุฅูู..." onkeyup="advancedSearchProducts()" style="padding: 8px; border: 2px solid #cbd5e0; border-radius: 6px;">
                        <button onclick="clearAdvancedSearch()" style="padding: 8px 15px; background: #dc3545; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">ูุณุญ</button>
                    </div>
                </div>
                
                <div id="productsTableContainer"></div>
            </div>
        </div>

        <!-- Master Inventory Tab -->
        <div class="tab-content" id="inventoryTab" style="display: none;">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 20px; align-items: center;">
                    <h2>๐ ุงููุฎุฒูู ุงูุฑุฆูุณู</h2>
                    <button class="add-btn" onclick="showAddInventory()">โ ุฅุถุงูุฉ ููุชุฌ</button>
                </div>
                
                <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #2196f3;">
                    <strong>๐ก ููู ูุนูู ุงููุธุงู:</strong>
                    <ol style="margin: 10px 0 0 20px;">
                        <li>ุฃุถู ุงูููุชุฌ ููุง ูู <strong>ุงููุฎุฒูู ุงูุฑุฆูุณู</strong></li>
                        <li>ุงุฐูุจ ูุชุจููุจ <strong>ุงูููุชุฌุงุช</strong> ูุชูุฒูุนู ุนูู ุงููุฑูุน</li>
                        <li>ุงูููุชุฌ ุงููุงุญุฏ ูููู ุชูุฒูุนู ุนูู ุนุฏุฉ ูุฑูุน ุจูููุงุช ูุฎุชููุฉ</li>
                    </ol>
                </div>
                
                <div id="inventoryTableContainer"></div>
            </div>
        </div>

        <!-- Products Tab (Branch Distribution) -->
        <div class="tab-content" id="invoicesTab" style="display: none;">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                    <h2>๐งพ ุงูููุงุชูุฑ</h2>
                    <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                        <select id="orderStatusFilter" onchange="filterInvoicesByStatus()" style="padding: 8px 14px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                            <option value="">๐ ูู ุงูุญุงูุงุช</option>
                            <option value="ููุฏ ุงูุชูููุฐ">โณ ููุฏ ุงูุชูููุฐ</option>
                            <option value="ููุฏ ุงูุชูุตูู">๐ ููุฏ ุงูุชูุตูู</option>
                            <option value="ููุฌุฒ">โ ููุฌุฒ</option>
                            <option value="ููุบูุฉ">๐ซ ููุบูุฉ</option>
                        </select>
                        <button class="btn" onclick="exportInvoicesExcel()">๐ ุชุตุฏูุฑ Excel</button>
                        <button class="btn-danger" onclick="clearAllInvoices()" id="clearInvoicesBtn" style="display: none;">๐๏ธ ุญุฐู ุงููู</button>
                    </div>
                </div>
                <div id="invoicesListContainer"></div>
            </div>
        </div>

        <!-- Returns Tab -->
        <div class="tab-content" id="returnsTab" style="display: none;">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>๐ ุงููุฑุชุฌุนุงุช</h2>
                    <button onclick="showAddReturn()" class="add-btn">โ ุฅุถุงูุฉ ูุฑุชุฌุน</button>
                </div>
                
                <div id="returnsTableContainer"></div>
            </div>
        </div>

        <!-- Customers Tab (CRM) -->
        <div class="tab-content" id="customersTab" style="display: none;">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>๐ฅ ุงูุนููุงุก (CRM)</h2>
                    <button onclick="showAddCustomer()" class="add-btn">โ ุฅุถุงูุฉ ุนููู</button>
                </div>
                
                <div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div class="form-group">
                            <label>ุงูุจุญุซ:</label>
                            <input type="text" id="customerSearch" placeholder="ุงุณูุ ูุงุชูุ ุนููุงู..." onkeyup="searchCustomers()">
                        </div>
                        <div style="display: flex; align-items: flex-end; gap: 10px;">
                            <button onclick="loadCustomers()" class="btn">๐ ุนุฑุถ ุงููู</button>
                            <button onclick="exportCustomersExcel()" class="btn" style="background: #38a169;">๐ ุชุตุฏูุฑ</button>
                        </div>
                    </div>
                </div>
                
                <div id="customersContainer"></div>
            </div>
        </div>

        <!-- Reports Tab -->
        <div class="tab-content" id="reportsTab" style="display: none;">
            <div style="padding: 20px;">
                <h2>๐ ุงูุชูุงุฑูุฑ</h2>
                
                <!-- ููุงุชุฑ ุงูุชูุงุฑูุฑ -->
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; align-items: end;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">ูู ุชุงุฑูุฎ:</label>
                            <input type="date" id="reportStartDate" style="width: 100%; padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">ุฅูู ุชุงุฑูุฎ:</label>
                            <input type="date" id="reportEndDate" style="width: 100%; padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">ุงููุฑุน:</label>
                            <select id="reportBranch" style="width: 100%; padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px;">
                                <option value="">ูู ุงููุฑูุน</option>
                            </select>
                        </div>
                        <button onclick="loadSalesReport()" class="btn" style="background: #667eea;">๐ ูุจูุนุงุช</button>
                        <button onclick="loadInventoryReport()" class="btn" style="background: #38a169;">๐ฆ ูุฎุฒูู</button>
                        <button onclick="loadDamagedReport()" class="btn" style="background: #e53e3e;">๐ ุชุงูู</button>
                    </div>
                </div>
                
                <!-- ูุชุงุฆุฌ ุงูุชูุงุฑูุฑ -->
                <div id="reportsContent"></div>
            </div>
        </div>

        <!-- System Logs Tab -->
        <div class="tab-content" id="systemlogsTab" style="display: none;">
            <div style="padding: 20px;">
                <h2>๐ ุณุฌู ุงููุธุงู</h2>
                <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #ffc107;">
                    <strong>โน๏ธ ููุงุญุธุฉ:</strong> ูุฐุง ุงูุณุฌู ูุชุงุญ ูููุฏูุฑ ููุท ููุนุฑุถ ุฌููุน ุงูุนูููุงุช ูู ุงููุธุงู
                </div>
                <!-- ููุงุชุฑ ุงูุจุญุซ -->
                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 15px; align-items: flex-end;">
                    <div style="flex: 1; min-width: 150px;">
                        <label style="display:block; font-size:12px; margin-bottom:4px; color:#666;">ููุน ุงูุนูููุฉ:</label>
                        <select id="logFilterAction" onchange="loadSystemLogs()" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ddd;">
                            <option value="">ุงููู</option>
                            <option value="login">๐ ุชุณุฌูู ุฏุฎูู</option>
                            <option value="logout">๐ช ุชุณุฌูู ุฎุฑูุฌ</option>
                            <option value="sale">๐ฐ ุจูุน</option>
                            <option value="edit_invoice">โ๏ธ ุชุนุฏูู ูุงุชูุฑุฉ</option>
                            <option value="cancel_invoice">โ ุฅูุบุงุก ูุงุชูุฑุฉ</option>
                            <option value="print_invoice">๐จ๏ธ ุทุจุงุนุฉ ูุงุชูุฑุฉ</option>
                            <option value="print_thermal">๐งพ ุทุจุงุนุฉ ุญุฑุงุฑูุฉ</option>
                            <option value="view_invoice">๐๏ธ ุนุฑุถ ูุงุชูุฑุฉ</option>
                            <option value="status_change">๐ ุชุบููุฑ ุญุงูุฉ</option>
                            <option value="return">โฉ๏ธ ูุฑุชุฌุน</option>
                            <option value="add_product">โ ุฅุถุงูุฉ ููุชุฌ</option>
                            <option value="edit_product">โ๏ธ ุชุนุฏูู ููุชุฌ</option>
                            <option value="delete_product">๐๏ธ ุญุฐู ููุชุฌ</option>
                            <option value="add_inventory">๐ฆ ุฅุถุงูุฉ ูุฎุฒูู</option>
                            <option value="edit_inventory">๐ฆ ุชุนุฏูู ูุฎุฒูู</option>
                            <option value="distribute">๐ค ุชูุฒูุน</option>
                            <option value="damage">๐ ุชุงูู</option>
                            <option value="add_user">๐ค ุฅุถุงูุฉ ูุณุชุฎุฏู</option>
                            <option value="edit_user">๐ค ุชุนุฏูู ูุณุชุฎุฏู</option>
                            <option value="delete_user">๐๏ธ ุญุฐู ูุณุชุฎุฏู</option>
                            <option value="add_customer">๐ฅ ุฅุถุงูุฉ ุนููู</option>
                            <option value="edit_customer">๐ฅ ุชุนุฏูู ุนููู</option>
                            <option value="delete_customer">๐๏ธ ุญุฐู ุนููู</option>
                            <option value="add_expense">๐ธ ุฅุถุงูุฉ ูุตุฑูู</option>
                            <option value="delete_expense">๐๏ธ ุญุฐู ูุตุฑูู</option>
                            <option value="shift_lock">๐ ููู ุดูุช</option>
                            <option value="create_transfer">๐ ุทูุจ ููู</option>
                            <option value="approve_transfer">โ ููุงููุฉ ููู</option>
                            <option value="reject_transfer">โ ุฑูุถ ููู</option>
                            <option value="pickup_transfer">๐ ุงุณุชูุงู ุณุงุฆู</option>
                            <option value="receive_transfer">๐ฆ ุชุฃููุฏ ุงุณุชูุงู ููู</option>
                        </select>
                    </div>
                    <div style="flex: 1; min-width: 150px;">
                        <label style="display:block; font-size:12px; margin-bottom:4px; color:#666;">ุงููุณุชุฎุฏู:</label>
                        <select id="logFilterUser" onchange="loadSystemLogs()" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ddd;">
                            <option value="">ุงููู</option>
                        </select>
                    </div>
                    <div style="flex: 1; min-width: 140px;">
                        <label style="display:block; font-size:12px; margin-bottom:4px; color:#666;">ูู ุชุงุฑูุฎ:</label>
                        <input type="date" id="logFilterDateFrom" onchange="loadSystemLogs()" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ddd;">
                    </div>
                    <div style="flex: 1; min-width: 140px;">
                        <label style="display:block; font-size:12px; margin-bottom:4px; color:#666;">ุฅูู ุชุงุฑูุฎ:</label>
                        <input type="date" id="logFilterDateTo" onchange="loadSystemLogs()" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ddd;">
                    </div>
                    <div>
                        <button onclick="clearLogFilters()" style="padding:8px 16px; border-radius:6px; border:1px solid #ddd; background:#f8f9fa; cursor:pointer;">ูุณุญ ุงูููุงุชุฑ</button>
                    </div>
                </div>
                <div id="systemLogsStats" style="margin-bottom:10px; font-size:13px; color:#666;"></div>
                <div id="systemLogsContent"></div>
                <div id="systemLogsPagination" style="text-align:center; margin-top:15px;"></div>
            </div>
        </div>

        <!-- Accounting Tab -->
        <div class="tab-content" id="accountingTab" style="display: none;">
            <div style="padding: 20px;" id="accountingContent"></div>
        </div>

        <!-- DCF Valuation Tab -->
        <div class="tab-content" id="dcfTab" style="display: none;">
            <div style="padding: 20px;">
                <h2>๐ ุชูููู ุงูุดุฑูุฉ - ุงูุชุฏููุงุช ุงูููุฏูุฉ ุงููุฎุตููุฉ (DCF)</h2>
                
                <!-- ููุงุญุธุฉ ุชูุถูุญูุฉ -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 12px; margin-bottom: 20px; color: white; box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);">
                    <h3 style="margin-bottom: 10px;">๐ก ููู ุชุณุชุฎุฏู ูุฐู ุงูุฃุฏุงุฉ:</h3>
                    <ol style="margin: 10px 0; padding-right: 25px; line-height: 1.8;">
                        <li>ุฃุฏุฎู ุงูุจูุงูุงุช ุงููุงููุฉ ููุดุฑูุฉ ูู ุงูุญููู ุฃุฏูุงู</li>
                        <li>ุงุถุบุท ุนูู ุฒุฑ "๐งฎ ุงุญุณุจ ุงูุชูููู"</li>
                        <li>ุณุชุธูุฑ ุงููุชุงุฆุฌ ูุน ุฌุฏูู ุชูุตููู ูุฑุณู ุจูุงูู</li>
                    </ol>
                    <p style="margin-top: 10px; font-size: 14px; opacity: 0.9;">
                        <strong>ููุงุญุธุฉ:</strong> DCF ูู ุฃุฏุงุฉ ูุชูููู ูููุฉ ุงูุดุฑูุฉ ุจูุงุกู ุนูู ุงูุชุฏููุงุช ุงูููุฏูุฉ ุงููุณุชูุจููุฉ ุงููุชููุนุฉ.
                    </p>
                </div>
                
                <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin-bottom: 20px; color: #667eea;">๐ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ</h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px;">
                        <div class="form-group">
                            <label>ุงูุชุฏูู ุงูููุฏู ุงูุญุงูู (ุงูุณูุฉ 0):</label>
                            <input type="number" id="dcf_initial_cf" step="0.01" value="100000" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                        </div>
                        
                        <div class="form-group">
                            <label>ูุนุฏู ุงูููู ุงููุชููุน (%):</label>
                            <input type="number" id="dcf_growth_rate" step="0.1" value="5" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                        </div>
                        
                        <div class="form-group">
                            <label>ูุนุฏู ุงูุฎุตู (WACC) (%):</label>
                            <input type="number" id="dcf_discount_rate" step="0.1" value="10" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                        </div>
                        
                        <div class="form-group">
                            <label>ุนุฏุฏ ุงูุณููุงุช:</label>
                            <input type="number" id="dcf_years" min="1" max="20" value="5" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                        </div>
                        
                        <div class="form-group">
                            <label>ูุนุฏู ุงูููู ุงูุฏุงุฆู (Terminal Growth) (%):</label>
                            <input type="number" id="dcf_terminal_growth" step="0.1" value="2" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                        </div>
                    </div>
                    
                    <button onclick="calculateDCF()" class="btn" style="width: 100%; padding: 12px; font-size: 16px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">๐งฎ ุงุญุณุจ ุงูุชูููู</button>
                </div>
                
                <!-- ุงููุชุงุฆุฌ -->
                <div id="dcfResults" style="display: none;">
                    <!-- ููุฎุต -->
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; border-radius: 12px; color: white; margin-bottom: 20px; text-align: center; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);">
                        <h3 style="margin-bottom: 15px;">๐ ูููุฉ ุงูุดุฑูุฉ ุงูููุฏุฑุฉ</h3>
                        <div style="font-size: 42px; font-weight: bold; margin: 20px 0;" id="dcfTotalValue">0</div>
                        <div style="font-size: 14px; opacity: 0.9;">ุงููููุฉ ุงูุญุงููุฉ ููุชุฏููุงุช ุงูููุฏูุฉ ุงููุณุชูุจููุฉ</div>
                    </div>
                    
                    <!-- ุงูุชูุงุตูู -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px;">
                        <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h4 style="color: #667eea; margin-bottom: 15px;">๐ ุงูุชุฏููุงุช ุงููุฎุตููุฉ</h4>
                            <div style="font-size: 28px; font-weight: bold; color: #2d3748;" id="dcfPVCashFlows">0</div>
                            <div style="font-size: 12px; color: #718096; margin-top: 5px;">ุงููููุฉ ุงูุญุงููุฉ ููุชุฏููุงุช (ุงูุณููุงุช 1-N)</div>
                        </div>
                        
                        <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h4 style="color: #667eea; margin-bottom: 15px;">โพ๏ธ ุงููููุฉ ุงููุชุจููุฉ</h4>
                            <div style="font-size: 28px; font-weight: bold; color: #2d3748;" id="dcfTerminalValue">0</div>
                            <div style="font-size: 12px; color: #718096; margin-top: 5px;">ุงููููุฉ ุงูุญุงููุฉ ููุชุฏููุงุช ุงูุฏุงุฆูุฉ</div>
                        </div>
                    </div>
                    
                    <!-- ุฌุฏูู ุงูุชูุงุตูู -->
                    <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <h4 style="color: #667eea; margin-bottom: 20px;">๐ ุชูุงุตูู ุงูุชุฏููุงุช ุงูุณูููุฉ</h4>
                        <div id="dcfTable" style="overflow-x: auto;"></div>
                    </div>
                    
                    <!-- ุงูุฑุณู ุงูุจูุงูู -->
                    <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-top: 20px;">
                        <h4 style="color: #667eea; margin-bottom: 20px;">๐ ุชุตูุฑ ุงูุชุฏููุงุช ุงูููุฏูุฉ</h4>
                        <canvas id="dcfChart" style="max-height: 300px;"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- XBRL / IFRS Tab -->
        <div class="tab-content" id="xbrlTab" style="display: none;">
            <div style="padding: 20px;">
                <h2>๐ ุชูุงุฑูุฑ XBRL - ูุนุงููุฑ IFRS ุงูุฏูููุฉ</h2>

                <!-- ุดุฑุญ -->
                <div style="background: linear-gradient(135deg, #1a365d 0%, #2b6cb0 100%); padding: 20px; border-radius: 12px; margin-bottom: 20px; color: white; box-shadow: 0 2px 8px rgba(26, 54, 93, 0.3);">
                    <h3 style="margin-bottom: 10px;">๐ ูุง ูู XBRLุ</h3>
                    <p style="line-height: 1.8; font-size: 14px;">
                        XBRL (eXtensible Business Reporting Language) ูู ูุนูุงุฑ ุฏููู ููุชูุงุฑูุฑ ุงููุงููุฉ ุงูุฅููุชุฑูููุฉ.
                        ูุชู ุชูููุฏ ุงูุชูุงุฑูุฑ ููู ุชุตููู IFRS (ุงููุนุงููุฑ ุงูุฏูููุฉ ููุชูุงุฑูุฑ ุงููุงููุฉ) ุชููุงุฆูุงู ูู ุจูุงูุงุช ุงููุธุงู ูุน ุฅููุงููุฉ ุฅุถุงูุฉ ุจูุงูุงุช ูุฏููุฉ.
                    </p>
                </div>

                <!-- === ุงููุณู 1: ุจูุงูุงุช ุงูุดุฑูุฉ === -->
                <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin-bottom: 20px; color: #1a365d; border-bottom: 2px solid #2b6cb0; padding-bottom: 10px;">๐ข ุจูุงูุงุช ุงูุดุฑูุฉ (Entity Information)</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px;">
                        <div class="form-group">
                            <label>ุงุณู ุงูุดุฑูุฉ (ุนุฑุจู):</label>
                            <input type="text" id="xbrl_company_name_ar" placeholder="ูุซุงู: ุดุฑูุฉ ุงููุฌุงุญ ุงูุชุฌุงุฑูุฉ" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                        </div>
                        <div class="form-group">
                            <label>Company Name (English):</label>
                            <input type="text" id="xbrl_company_name_en" placeholder="e.g. Al-Najah Trading Co." style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%; direction: ltr; text-align: left;">
                        </div>
                        <div class="form-group">
                            <label>ุงูุณุฌู ุงูุชุฌุงุฑู (CR):</label>
                            <input type="text" id="xbrl_cr_number" placeholder="ูุซุงู: 1010XXXXXX" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%; direction: ltr;">
                        </div>
                        <div class="form-group">
                            <label>ุงูุฑูู ุงูุถุฑูุจู (VAT):</label>
                            <input type="text" id="xbrl_tax_number" placeholder="ูุซุงู: 3XXXXXXXXXX0003" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%; direction: ltr;">
                        </div>
                        <div class="form-group">
                            <label>ุนููุฉ ุงูุชูุฑูุฑ:</label>
                            <select id="xbrl_currency" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                                <option value="SAR">ุฑูุงู ุณุนูุฏู (SAR)</option>
                                <option value="AED">ุฏุฑูู ุฅูุงุฑุงุชู (AED)</option>
                                <option value="KWD">ุฏููุงุฑ ูููุชู (KWD)</option>
                                <option value="BHD">ุฏููุงุฑ ุจุญุฑููู (BHD)</option>
                                <option value="QAR">ุฑูุงู ูุทุฑู (QAR)</option>
                                <option value="OMR">ุฑูุงู ุนูุงูู (OMR)</option>
                                <option value="EGP">ุฌููู ูุตุฑู (EGP)</option>
                                <option value="JOD">ุฏููุงุฑ ุฃุฑุฏูู (JOD)</option>
                                <option value="USD">ุฏููุงุฑ ุฃูุฑููู (USD)</option>
                                <option value="EUR">ููุฑู (EUR)</option>
                                <option value="GBP">ุฌููู ุฅุณุชุฑูููู (GBP)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ุงููุทุงุน ุงูุตูุงุนู:</label>
                            <select id="xbrl_sector" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                                <option value="ุชุฌุงุฑุฉ ุชุฌุฒุฆุฉ">ุชุฌุงุฑุฉ ุชุฌุฒุฆุฉ</option>
                                <option value="ุชุฌุงุฑุฉ ุฌููุฉ">ุชุฌุงุฑุฉ ุฌููุฉ</option>
                                <option value="ูุทุงุนู ูุถูุงูุฉ">ูุทุงุนู ูุถูุงูุฉ</option>
                                <option value="ุฎุฏูุงุช">ุฎุฏูุงุช</option>
                                <option value="ุชุตููุน">ุชุตููุน</option>
                                <option value="ุฃุฎุฑู">ุฃุฎุฑู</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ุงูุฏููุฉ:</label>
                            <select id="xbrl_country" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                                <option value="SA">ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ</option>
                                <option value="AE">ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ</option>
                                <option value="KW">ุงููููุช</option>
                                <option value="BH">ุงูุจุญุฑูู</option>
                                <option value="QA">ูุทุฑ</option>
                                <option value="OM">ุนูุงู</option>
                                <option value="EG">ูุตุฑ</option>
                                <option value="JO">ุงูุฃุฑุฏู</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ุงูุดูู ุงููุงูููู:</label>
                            <select id="xbrl_legal_form" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                                <option value="ูุคุณุณุฉ ูุฑุฏูุฉ">ูุคุณุณุฉ ูุฑุฏูุฉ</option>
                                <option value="ุดุฑูุฉ ุฐุงุช ูุณุคูููุฉ ูุญุฏูุฏุฉ">ุดุฑูุฉ ุฐุงุช ูุณุคูููุฉ ูุญุฏูุฏุฉ</option>
                                <option value="ุดุฑูุฉ ูุณุงููุฉ ููููุฉ">ุดุฑูุฉ ูุณุงููุฉ ููููุฉ</option>
                                <option value="ุดุฑูุฉ ูุณุงููุฉ ุนุงูุฉ">ุดุฑูุฉ ูุณุงููุฉ ุนุงูุฉ</option>
                                <option value="ุดุฑูุฉ ุชุถุงูู">ุดุฑูุฉ ุชุถุงูู</option>
                                <option value="ุดุฑูุฉ ุชูุตูุฉ ุจุณูุทุฉ">ุดุฑูุฉ ุชูุตูุฉ ุจุณูุทุฉ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ููุงูุฉ ุงูุณูุฉ ุงููุงููุฉ:</label>
                            <select id="xbrl_fiscal_year_end" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                                <option value="12-31">31 ุฏูุณูุจุฑ</option>
                                <option value="03-31">31 ูุงุฑุณ</option>
                                <option value="06-30">30 ููููู</option>
                                <option value="09-30">30 ุณุจุชูุจุฑ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:</label>
                            <input type="email" id="xbrl_email" placeholder="info@company.com" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%; direction: ltr; text-align: left;">
                        </div>
                        <div class="form-group">
                            <label>ุฑูู ุงููุงุชู:</label>
                            <input type="text" id="xbrl_phone" placeholder="+966XXXXXXXXX" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%; direction: ltr;">
                        </div>
                        <div class="form-group">
                            <label>ุงูุนููุงู:</label>
                            <input type="text" id="xbrl_address" placeholder="ุงููุฏููุฉุ ุงูุญูุ ุงูุดุงุฑุน" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                        </div>
                    </div>
                    <button onclick="saveXBRLCompanyInfo()" class="btn" style="margin-top: 15px; padding: 10px 30px; background: linear-gradient(135deg, #1a365d, #2b6cb0); color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 14px;">๐พ ุญูุธ ุจูุงูุงุช ุงูุดุฑูุฉ</button>
                </div>

                <!-- === ุงููุณู 2: ูุชุฑุฉ ุงูุชูุฑูุฑ ูุฌูุจ ุงูุจูุงูุงุช === -->
                <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin-bottom: 20px; color: #1a365d; border-bottom: 2px solid #2b6cb0; padding-bottom: 10px;">๐ ูุชุฑุฉ ุงูุชูุฑูุฑ</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; align-items: end;">
                        <div class="form-group">
                            <label>ูู ุชุงุฑูุฎ:</label>
                            <input type="date" id="xbrl_period_start" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                        </div>
                        <div class="form-group">
                            <label>ุฅูู ุชุงุฑูุฎ:</label>
                            <input type="date" id="xbrl_period_end" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                        </div>
                        <div>
                            <button onclick="loadXBRLFinancialData()" class="btn" style="padding: 12px 30px; background: linear-gradient(135deg, #2b6cb0, #4299e1); color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; width: 100%;">๐ ุฌูุจ ุงูุจูุงูุงุช ูู ุงููุธุงู</button>
                        </div>
                    </div>
                </div>

                <!-- === ุงููุณู 3: ูุงุฆูุฉ ุงูุฏุฎู === -->
                <div id="xbrl_income_section" style="display: none;">
                    <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <h3 style="margin-bottom: 20px; color: #1a365d; border-bottom: 2px solid #2b6cb0; padding-bottom: 10px;">๐ ูุงุฆูุฉ ุงูุฏุฎู ุงูุดุงูู (Statement of Comprehensive Income)</h3>
                        <p style="color: #718096; font-size: 13px; margin-bottom: 15px;">ุงูุจูุงูุงุช ุงููุณุชุฎุฑุฌุฉ ูู ุงููุธุงู ุชููุงุฆูุงู + ููููู ุฅุถุงูุฉ ุชุนุฏููุงุช ูุฏููุฉ</p>

                        <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
                            <thead>
                                <tr style="background: #1a365d; color: white;">
                                    <th style="padding: 12px 15px; text-align: right; border-radius: 8px 0 0 0;">ุงูุจูุฏ</th>
                                    <th style="padding: 12px 15px; text-align: right;">IFRS Element</th>
                                    <th style="padding: 12px 15px; text-align: center;">ูู ุงููุธุงู</th>
                                    <th style="padding: 12px 15px; text-align: center;">ุชุนุฏูู ูุฏูู</th>
                                    <th style="padding: 12px 15px; text-align: center; border-radius: 0 8px 0 0;">ุงูุฅุฌูุงูู</th>
                                </tr>
                            </thead>
                            <tbody id="xbrl_income_tbody">
                            </tbody>
                        </table>
                    </div>

                    <!-- === ุงููุณู 4: ูุงุฆูุฉ ุงููุฑูุฒ ุงููุงูู === -->
                    <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <h3 style="margin-bottom: 20px; color: #1a365d; border-bottom: 2px solid #2b6cb0; padding-bottom: 10px;">๐ฆ ูุงุฆูุฉ ุงููุฑูุฒ ุงููุงูู (Statement of Financial Position)</h3>
                        <p style="color: #718096; font-size: 13px; margin-bottom: 15px;">ุฃุฏุฎู ุงูุฃุฑุตุฏุฉ ูู ุงูุฏูุงุชุฑ + ุจูุงูุงุช ุงููุฎุฒูู ุงูุชููุงุฆูุฉ</p>

                        <h4 style="color: #2b6cb0; margin: 15px 0 10px;">ุงูุฃุตูู ุงููุชุฏุงููุฉ (Current Assets)</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div class="form-group">
                                <label>ุงูููุฏ ููุง ูุนุงุฏูู:</label>
                                <input type="number" id="xbrl_cash" step="0.01" value="0" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุฐูู ูุฏููุฉ ุชุฌุงุฑูุฉ:</label>
                                <input type="number" id="xbrl_receivables" step="0.01" value="0" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุงููุฎุฒูู (IAS 2) <span style="color: #48bb78;">โ ุชููุงุฆู</span>:</label>
                                <input type="number" id="xbrl_inventory_val" step="0.01" value="0" readonly style="padding: 10px; border: 2px solid #48bb78; border-radius: 6px; width: 100%; background: #f0fff4;">
                            </div>
                            <div class="form-group">
                                <label>ุฃุตูู ูุชุฏุงููุฉ ุฃุฎุฑู:</label>
                                <input type="number" id="xbrl_other_current_assets" step="0.01" value="0" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                        </div>
                        <div style="background: #ebf8ff; padding: 12px 15px; border-radius: 8px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                            <strong>ุฅุฌูุงูู ุงูุฃุตูู ุงููุชุฏุงููุฉ:</strong>
                            <strong id="xbrl_total_current_assets" style="font-size: 18px; color: #2b6cb0;">0.00</strong>
                        </div>

                        <h4 style="color: #2b6cb0; margin: 15px 0 10px;">ุงูุฃุตูู ุบูุฑ ุงููุชุฏุงููุฉ (Non-Current Assets)</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div class="form-group">
                                <label>ููุชููุงุช ููุนุฏุงุช (IAS 16):</label>
                                <input type="number" id="xbrl_ppe" step="0.01" value="0" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุฃุตูู ุบูุฑ ููููุณุฉ (IAS 38):</label>
                                <input type="number" id="xbrl_intangibles" step="0.01" value="0" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุฃุตูู ุบูุฑ ูุชุฏุงููุฉ ุฃุฎุฑู:</label>
                                <input type="number" id="xbrl_other_non_current_assets" step="0.01" value="0" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                        </div>
                        <div style="background: #ebf8ff; padding: 12px 15px; border-radius: 8px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                            <strong>ุฅุฌูุงูู ุงูุฃุตูู ุบูุฑ ุงููุชุฏุงููุฉ:</strong>
                            <strong id="xbrl_total_non_current_assets" style="font-size: 18px; color: #2b6cb0;">0.00</strong>
                        </div>
                        <div style="background: #1a365d; padding: 15px; border-radius: 8px; margin-bottom: 25px; display: flex; justify-content: space-between; align-items: center; color: white;">
                            <strong style="font-size: 16px;">ุฅุฌูุงูู ุงูุฃุตูู:</strong>
                            <strong id="xbrl_total_assets" style="font-size: 22px;">0.00</strong>
                        </div>

                        <h4 style="color: #c53030; margin: 15px 0 10px;">ุงูุฎุตูู ุงููุชุฏุงููุฉ (Current Liabilities)</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div class="form-group">
                                <label>ุฐูู ุฏุงุฆูุฉ ุชุฌุงุฑูุฉ:</label>
                                <input type="number" id="xbrl_payables" step="0.01" value="0" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ูุฑูุถ ูุตูุฑุฉ ุงูุฃุฌู:</label>
                                <input type="number" id="xbrl_short_loans" step="0.01" value="0" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุฎุตูู ูุชุฏุงููุฉ ุฃุฎุฑู:</label>
                                <input type="number" id="xbrl_other_current_liabilities" step="0.01" value="0" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                        </div>
                        <div style="background: #fff5f5; padding: 12px 15px; border-radius: 8px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                            <strong>ุฅุฌูุงูู ุงูุฎุตูู ุงููุชุฏุงููุฉ:</strong>
                            <strong id="xbrl_total_current_liabilities" style="font-size: 18px; color: #c53030;">0.00</strong>
                        </div>

                        <h4 style="color: #c53030; margin: 15px 0 10px;">ุงูุฎุตูู ุบูุฑ ุงููุชุฏุงููุฉ (Non-Current Liabilities)</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div class="form-group">
                                <label>ูุฑูุถ ุทูููุฉ ุงูุฃุฌู:</label>
                                <input type="number" id="xbrl_long_loans" step="0.01" value="0" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุฎุตูู ุบูุฑ ูุชุฏุงููุฉ ุฃุฎุฑู:</label>
                                <input type="number" id="xbrl_other_non_current_liabilities" step="0.01" value="0" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                        </div>
                        <div style="background: #fff5f5; padding: 12px 15px; border-radius: 8px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                            <strong>ุฅุฌูุงูู ุงูุฎุตูู ุบูุฑ ุงููุชุฏุงููุฉ:</strong>
                            <strong id="xbrl_total_non_current_liabilities" style="font-size: 18px; color: #c53030;">0.00</strong>
                        </div>
                        <div style="background: #c53030; padding: 15px; border-radius: 8px; margin-bottom: 25px; display: flex; justify-content: space-between; align-items: center; color: white;">
                            <strong style="font-size: 16px;">ุฅุฌูุงูู ุงูุฎุตูู:</strong>
                            <strong id="xbrl_total_liabilities" style="font-size: 22px;">0.00</strong>
                        </div>

                        <h4 style="color: #38a169; margin: 15px 0 10px;">ุญููู ุงูููููุฉ (Equity)</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div class="form-group">
                                <label>ุฑุฃุณ ุงููุงู:</label>
                                <input type="number" id="xbrl_share_capital" step="0.01" value="0" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุฃุฑุจุงุญ ูุจูุงุฉ (ูุจู ุงููุชุฑุฉ):</label>
                                <input type="number" id="xbrl_retained_earnings" step="0.01" value="0" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุจููุฏ ุฃุฎุฑู ูู ุญููู ุงูููููุฉ:</label>
                                <input type="number" id="xbrl_other_equity" step="0.01" value="0" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                        </div>
                        <div style="background: #f0fff4; padding: 15px; border-radius: 8px; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center;">
                            <strong style="font-size: 16px; color: #38a169;">ุฅุฌูุงูู ุญููู ุงูููููุฉ:</strong>
                            <strong id="xbrl_total_equity" style="font-size: 22px; color: #38a169;">0.00</strong>
                        </div>
                        <div style="background: #2d3748; padding: 15px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; color: white;">
                            <strong style="font-size: 16px;">ุฅุฌูุงูู ุงูุฎุตูู + ุญููู ุงูููููุฉ:</strong>
                            <strong id="xbrl_liabilities_equity" style="font-size: 22px;">0.00</strong>
                        </div>
                    </div>

                    <!-- === ูุงุฆูุฉ ุงูุชุฏููุงุช ุงูููุฏูุฉ - Cash Flow Statement (IAS 7) === -->
                    <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <h3 style="margin-bottom: 20px; color: #1a365d; border-bottom: 2px solid #2b6cb0; padding-bottom: 10px;">๐ฐ ูุงุฆูุฉ ุงูุชุฏููุงุช ุงูููุฏูุฉ (Statement of Cash Flows - IAS 7)</h3>
                        <p style="color: #718096; font-size: 13px; margin-bottom: 15px;">ุงูุทุฑููุฉ ุงููุจุงุดุฑุฉ - ุฃุฏุฎู ุงููุจุงูุบ ุงููุนููุฉ ุงููุญุตูุฉ ูุงููุฏููุนุฉ. ุงูุจูุงูุงุช ุงููุญุณูุจุฉ ูู ุงููุธุงู ุชุธูุฑ ูููู ุงูุชุฑุงุถูุฉ.</p>

                        <!-- ุฑุตูุฏ ุงูููุฏ ูู ุจุฏุงูุฉ ุงููุชุฑุฉ -->
                        <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                            <div class="form-group" style="max-width: 300px;">
                                <label style="font-weight: bold; color: #1a365d;">ุฑุตูุฏ ุงูููุฏ ูู ุจุฏุงูุฉ ุงููุชุฑุฉ:</label>
                                <input type="number" id="xbrl_cash_beginning" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #2b6cb0; border-radius: 6px; width: 100%;">
                            </div>
                        </div>

                        <h4 style="color: #38a169; margin: 15px 0 10px;">ุงูุฃูุดุทุฉ ุงูุชุดุบูููุฉ (Operating Activities)</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 15px;">
                            <div class="form-group">
                                <label>ูุญุตูุงุช ูู ุงูุนููุงุก <span style="color: #48bb78;">โ ุชููุงุฆู</span>:</label>
                                <input type="number" id="xbrl_cf_customers" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #48bb78; border-radius: 6px; width: 100%; background: #f0fff4;">
                            </div>
                            <div class="form-group">
                                <label>ูุฏููุนุงุช ููููุฑุฏูู <span style="color: #48bb78;">โ ุชููุงุฆู</span>:</label>
                                <input type="number" id="xbrl_cf_suppliers" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #48bb78; border-radius: 6px; width: 100%; background: #f0fff4;">
                            </div>
                            <div class="form-group">
                                <label>ูุฏููุนุงุช ููููุธููู <span style="color: #48bb78;">โ ุชููุงุฆู</span>:</label>
                                <input type="number" id="xbrl_cf_employees" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #48bb78; border-radius: 6px; width: 100%; background: #f0fff4;">
                            </div>
                            <div class="form-group">
                                <label>ูุตุงุฑูู ุชุดุบูููุฉ ุฃุฎุฑู ูุฏููุนุฉ:</label>
                                <input type="number" id="xbrl_cf_other_operating" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ููุงุฆุฏ ูุฏููุนุฉ:</label>
                                <input type="number" id="xbrl_cf_interest_paid" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุฒูุงุฉ / ุถุฑุงุฆุจ ูุฏููุนุฉ:</label>
                                <input type="number" id="xbrl_cf_taxes_paid" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                        </div>
                        <div style="background: #f0fff4; padding: 12px 15px; border-radius: 8px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                            <strong style="color: #38a169;">ุตุงูู ุงูููุฏ ูู ุงูุฃูุดุทุฉ ุงูุชุดุบูููุฉ:</strong>
                            <strong id="xbrl_net_cash_operating" style="font-size: 18px; color: #38a169;">0.00</strong>
                        </div>

                        <h4 style="color: #805ad5; margin: 15px 0 10px;">ุงูุฃูุดุทุฉ ุงูุงุณุชุซูุงุฑูุฉ (Investing Activities)</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 15px;">
                            <div class="form-group">
                                <label>ุดุฑุงุก ููุชููุงุช ููุนุฏุงุช:</label>
                                <input type="number" id="xbrl_cf_ppe_purchased" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุจูุน ููุชููุงุช ููุนุฏุงุช:</label>
                                <input type="number" id="xbrl_cf_ppe_sold" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุดุฑุงุก ุงุณุชุซูุงุฑุงุช:</label>
                                <input type="number" id="xbrl_cf_inv_purchased" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุจูุน ุงุณุชุซูุงุฑุงุช:</label>
                                <input type="number" id="xbrl_cf_inv_sold" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุฃูุดุทุฉ ุงุณุชุซูุงุฑูุฉ ุฃุฎุฑู:</label>
                                <input type="number" id="xbrl_cf_other_investing" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                        </div>
                        <div style="background: #faf5ff; padding: 12px 15px; border-radius: 8px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                            <strong style="color: #805ad5;">ุตุงูู ุงูููุฏ ูู ุงูุฃูุดุทุฉ ุงูุงุณุชุซูุงุฑูุฉ:</strong>
                            <strong id="xbrl_net_cash_investing" style="font-size: 18px; color: #805ad5;">0.00</strong>
                        </div>

                        <h4 style="color: #dd6b20; margin: 15px 0 10px;">ุงูุฃูุดุทุฉ ุงูุชูููููุฉ (Financing Activities)</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 15px;">
                            <div class="form-group">
                                <label>ูุฑูุถ ูุญุตูุฉ:</label>
                                <input type="number" id="xbrl_cf_loans_received" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุณุฏุงุฏ ูุฑูุถ:</label>
                                <input type="number" id="xbrl_cf_loans_repaid" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุฑุฃุณ ูุงู ูุณุงูู ุฌุฏูุฏ:</label>
                                <input type="number" id="xbrl_cf_capital" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุฃุฑุจุงุญ ููุฒุนุฉ:</label>
                                <input type="number" id="xbrl_cf_dividends" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุฃูุดุทุฉ ุชูููููุฉ ุฃุฎุฑู:</label>
                                <input type="number" id="xbrl_cf_other_financing" step="0.01" value="0" onchange="recalcXBRLCashFlow()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                        </div>
                        <div style="background: #fffaf0; padding: 12px 15px; border-radius: 8px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                            <strong style="color: #dd6b20;">ุตุงูู ุงูููุฏ ูู ุงูุฃูุดุทุฉ ุงูุชูููููุฉ:</strong>
                            <strong id="xbrl_net_cash_financing" style="font-size: 18px; color: #dd6b20;">0.00</strong>
                        </div>

                        <!-- ููุฎุต ุงูุชุฏููุงุช -->
                        <div style="background: #1a365d; padding: 15px; border-radius: 8px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; color: white;">
                            <strong style="font-size: 16px;">ุตุงูู ุงูุชุบูุฑ ูู ุงูููุฏ:</strong>
                            <strong id="xbrl_net_change_cash" style="font-size: 22px;">0.00</strong>
                        </div>
                        <div style="background: #2b6cb0; padding: 15px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; color: white;">
                            <strong style="font-size: 16px;">ุฑุตูุฏ ุงูููุฏ ูู ููุงูุฉ ุงููุชุฑุฉ:</strong>
                            <strong id="xbrl_cash_ending" style="font-size: 22px;">0.00</strong>
                        </div>
                    </div>

                    <!-- === ูุงุฆูุฉ ุงูุชุบูุฑุงุช ูู ุญููู ุงูููููุฉ - Statement of Changes in Equity (IAS 1) === -->
                    <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <h3 style="margin-bottom: 20px; color: #1a365d; border-bottom: 2px solid #2b6cb0; padding-bottom: 10px;">๐ ูุงุฆูุฉ ุงูุชุบูุฑุงุช ูู ุญููู ุงูููููุฉ (Statement of Changes in Equity - IAS 1)</h3>
                        <p style="color: #718096; font-size: 13px; margin-bottom: 15px;">ุฃุฏุฎู ุงูุฃุฑุตุฏุฉ ุงูุงูุชุชุงุญูุฉ ูุงูุชุบูุฑุงุช ุฎูุงู ุงููุชุฑุฉ. ุตุงูู ุงูุฑุจุญ ููุญุณุจ ุชููุงุฆูุงู ูู ูุงุฆูุฉ ุงูุฏุฎู.</p>

                        <h4 style="color: #2b6cb0; margin: 15px 0 10px;">ุงูุฃุฑุตุฏุฉ ุงูุงูุชุชุงุญูุฉ (ุจุฏุงูุฉ ุงููุชุฑุฉ)</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 15px;">
                            <div class="form-group">
                                <label>ุฑุฃุณ ุงููุงู ุงูุงูุชุชุงุญู:</label>
                                <input type="number" id="xbrl_eq_opening_capital" step="0.01" value="0" onchange="recalcXBRLEquityChanges()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุฃุฑุจุงุญ ูุจูุงุฉ ุงูุชุชุงุญูุฉ:</label>
                                <input type="number" id="xbrl_eq_opening_retained" step="0.01" value="0" onchange="recalcXBRLEquityChanges()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุงุญุชูุงุทูุงุช ูุจููุฏ ุฃุฎุฑู ุงูุชุชุงุญูุฉ:</label>
                                <input type="number" id="xbrl_eq_opening_other" step="0.01" value="0" onchange="recalcXBRLEquityChanges()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                        </div>
                        <div style="background: #ebf8ff; padding: 12px 15px; border-radius: 8px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                            <strong style="color: #2b6cb0;">ุฅุฌูุงูู ุญููู ุงูููููุฉ ุงูุงูุชุชุงุญูุฉ:</strong>
                            <strong id="xbrl_eq_opening_total" style="font-size: 18px; color: #2b6cb0;">0.00</strong>
                        </div>

                        <h4 style="color: #38a169; margin: 15px 0 10px;">ุงูุชุบูุฑุงุช ุฎูุงู ุงููุชุฑุฉ</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 15px;">
                            <div class="form-group">
                                <label>ุตุงูู ุฑุจุญ ุงููุชุฑุฉ <span style="color: #48bb78;">โ ุชููุงุฆู</span>:</label>
                                <input type="number" id="xbrl_eq_net_profit" step="0.01" value="0" readonly style="padding: 10px; border: 2px solid #48bb78; border-radius: 6px; width: 100%; background: #f0fff4;">
                            </div>
                            <div class="form-group">
                                <label>ุงูุฏุฎู ุงูุดุงูู ุงูุขุฎุฑ (OCI):</label>
                                <input type="number" id="xbrl_eq_oci" step="0.01" value="0" onchange="recalcXBRLEquityChanges()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุฒูุงุฏุฉ ุฑุฃุณ ุงููุงู:</label>
                                <input type="number" id="xbrl_eq_new_capital" step="0.01" value="0" onchange="recalcXBRLEquityChanges()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุฃุฑุจุงุญ ููุฒุนุฉ (ุชูุฒูุนุงุช):</label>
                                <input type="number" id="xbrl_eq_dividends" step="0.01" value="0" onchange="recalcXBRLEquityChanges()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                        </div>

                        <h4 style="color: #e67e22; margin: 20px 0 10px;">๐ฅ ุจูุงูุงุช ุงูุดุฑูุงุก (IAS 1 - ุชูุตูู ููู ุดุฑูู)</h4>
                        <p style="color: #718096; font-size: 12px; margin-bottom: 10px;">ุฃุฏุฎู ุจูุงูุงุช ูู ุดุฑูู: ูุณุจุฉ ุงูููููุฉ ูุชูุฒูุนุงุช ุงูุฃุฑุจุงุญ ูุงูุชุบูุฑ ูู ุฑุฃุณ ุงููุงู. ูุตูุจ ุงูุฑุจุญ ููุญุณุจ ุชููุงุฆูุงู.</p>
                        <div id="xbrl_partners_container"></div>
                        <button type="button" onclick="addXBRLPartner()" style="background: #e67e22; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; margin: 10px 0 20px; font-size: 14px;">โ ุฅุถุงูุฉ ุดุฑูู</button>

                        <h4 style="color: #1a365d; margin: 15px 0 10px;">ุงูุฃุฑุตุฏุฉ ุงูุฎุชุงููุฉ (ููุงูุฉ ุงููุชุฑุฉ)</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                            <div style="background: #f7fafc; padding: 12px 15px; border-radius: 8px; text-align: center;">
                                <div style="color: #718096; font-size: 12px;">ุฑุฃุณ ุงููุงู</div>
                                <div id="xbrl_eq_closing_capital" style="font-size: 18px; font-weight: bold; color: #2d3748;">0.00</div>
                            </div>
                            <div style="background: #f7fafc; padding: 12px 15px; border-radius: 8px; text-align: center;">
                                <div style="color: #718096; font-size: 12px;">ุฃุฑุจุงุญ ูุจูุงุฉ</div>
                                <div id="xbrl_eq_closing_retained" style="font-size: 18px; font-weight: bold; color: #2d3748;">0.00</div>
                            </div>
                            <div style="background: #f7fafc; padding: 12px 15px; border-radius: 8px; text-align: center;">
                                <div style="color: #718096; font-size: 12px;">ุจููุฏ ุฃุฎุฑู</div>
                                <div id="xbrl_eq_closing_other" style="font-size: 18px; font-weight: bold; color: #2d3748;">0.00</div>
                            </div>
                        </div>
                        <div style="background: #38a169; padding: 15px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; color: white;">
                            <strong style="font-size: 16px;">ุฅุฌูุงูู ุญููู ุงูููููุฉ ุงูุฎุชุงููุฉ:</strong>
                            <strong id="xbrl_eq_closing_total" style="font-size: 22px;">0.00</strong>
                        </div>
                    </div>

                    <!-- === ุงููุณู 5: ุชุนุฏููุงุช ูุฏููุฉ ุนูู ูุงุฆูุฉ ุงูุฏุฎู === -->
                    <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <h3 style="margin-bottom: 20px; color: #1a365d; border-bottom: 2px solid #2b6cb0; padding-bottom: 10px;">โ๏ธ ุชุนุฏููุงุช ูุฏููุฉ ุนูู ูุงุฆูุฉ ุงูุฏุฎู</h3>
                        <p style="color: #718096; font-size: 13px; margin-bottom: 15px;">ุฃุถู ุจููุฏ ุบูุฑ ูุณุฌูุฉ ูู ุงููุธุงู ูุซู ุงูุงุณุชููุงู ูุชูุงููู ุงูุชูููู ูุงูุฒูุงุฉ</p>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                            <div class="form-group">
                                <label>ุฅูุฑุงุฏุงุช ุฃุฎุฑู:</label>
                                <input type="number" id="xbrl_other_income" step="0.01" value="0" onchange="recalcXBRLIncome()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ูุตุงุฑูู ุฅุถุงููุฉ:</label>
                                <input type="number" id="xbrl_additional_expenses" step="0.01" value="0" onchange="recalcXBRLIncome()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุงูุงุณุชููุงู ูุงูุฅุทูุงุก (IAS 16):</label>
                                <input type="number" id="xbrl_depreciation" step="0.01" value="0" onchange="recalcXBRLIncome()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุชูุงููู ุงูุชูููู (IFRS 9):</label>
                                <input type="number" id="xbrl_finance_costs" step="0.01" value="0" onchange="recalcXBRLIncome()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>ุงูุฒูุงุฉ / ุถุฑูุจุฉ ุงูุฏุฎู (IAS 12):</label>
                                <input type="number" id="xbrl_zakat" step="0.01" value="0" onchange="recalcXBRLIncome()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            </div>
                        </div>
                    </div>

                    <!-- === ุงููุณู 6: ุชูููุฏ XBRL === -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                        <button onclick="generateXBRLReport()" class="btn" style="padding: 15px; font-size: 16px; background: linear-gradient(135deg, #1a365d, #2b6cb0); color: white; border: none; border-radius: 10px; cursor: pointer;">๐ ุชูููุฏ ุชูุฑูุฑ XBRL</button>
                        <button onclick="downloadXBRLXML()" id="xbrl_download_btn" class="btn" style="padding: 15px; font-size: 16px; background: linear-gradient(135deg, #38a169, #48bb78); color: white; border: none; border-radius: 10px; cursor: pointer; display: none;">โฌ๏ธ ุชุญููู ููู XBRL (.xml)</button>
                    </div>

                    <!-- === ุงููุณู 7: ููุฎุต ูุนุฑุถ ุงููุชุงุฆุฌ === -->
                    <div id="xbrl_results" style="display: none;">
                        <div style="background: linear-gradient(135deg, #1a365d, #2b6cb0); padding: 25px; border-radius: 12px; color: white; margin-bottom: 20px; text-align: center;">
                            <h3 style="margin-bottom: 10px;">โ ุชู ุชูููุฏ ุชูุฑูุฑ XBRL ุจูุฌุงุญ</h3>
                            <div style="font-size: 14px; opacity: 0.9;" id="xbrl_report_period"></div>
                        </div>

                        <!-- ููุฎุต ูุงุฆูุฉ ุงูุฏุฎู -->
                        <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h4 style="color: #1a365d; margin-bottom: 15px;">๐ ููุฎุต ูุงุฆูุฉ ุงูุฏุฎู</h4>
                            <div id="xbrl_income_summary"></div>
                        </div>

                        <!-- ููุฎุต ุงููุฑูุฒ ุงููุงูู -->
                        <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h4 style="color: #1a365d; margin-bottom: 15px;">๐ฆ ููุฎุต ุงููุฑูุฒ ุงููุงูู</h4>
                            <div id="xbrl_balance_summary"></div>
                        </div>

                        <!-- ููุฎุต ุงูุชุฏููุงุช ุงูููุฏูุฉ -->
                        <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h4 style="color: #1a365d; margin-bottom: 15px;">๐ฐ ููุฎุต ุงูุชุฏููุงุช ุงูููุฏูุฉ</h4>
                            <div id="xbrl_cashflow_summary"></div>
                        </div>

                        <!-- ููุฎุต ุงูุชุบูุฑุงุช ูู ุญููู ุงูููููุฉ -->
                        <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h4 style="color: #1a365d; margin-bottom: 15px;">๐ ููุฎุต ุงูุชุบูุฑุงุช ูู ุญููู ุงูููููุฉ</h4>
                            <div id="xbrl_equity_summary"></div>
                        </div>

                        <!-- ุนุฑุถ XML -->
                        <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h4 style="color: #1a365d; margin-bottom: 15px;">๐ ููุฏ Inline XBRL (iXBRL/HTML)</h4>
                            <pre id="xbrl_xml_preview" dir="ltr" style="background: #1a202c; color: #68d391; padding: 20px; border-radius: 8px; font-size: 12px; overflow-x: auto; max-height: 400px; line-height: 1.6; white-space: pre-wrap;"></pre>
                        </div>
                    </div>

                    <!-- === ุงููุณู 8: ุงูุชูุงุฑูุฑ ุงููุญููุธุฉ === -->
                    <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <h3 style="margin-bottom: 20px; color: #1a365d; border-bottom: 2px solid #2b6cb0; padding-bottom: 10px;">๐ ุงูุชูุงุฑูุฑ ุงููุญููุธุฉ</h3>
                        <div id="xbrl_saved_reports"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Users Tab -->
        <div class="tab-content" id="usersTab" style="display: none;">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                    <h2>๐ฅ ุงููุณุชุฎุฏููู</h2>
                    <div style="display: flex; gap: 10px;">
                        <button class="add-btn" onclick="openShiftsManagement()" style="background: #e67e22;">๐ ุงูุดูุชุงุช</button>
                        <button class="add-btn" onclick="showAddUser()">โ ุฅุถุงูุฉ</button>
                    </div>
                </div>
                <div id="usersTableContainer"></div>
            </div>
        </div>

        <!-- Branches Tab -->
        <div class="tab-content" id="branchesTab" style="display: none;">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                    <h2>๐ข ุฅุฏุงุฑุฉ ุงููุฑูุน</h2>
                    <button class="add-btn" onclick="showAddBranch()">โ ุฅุถุงูุฉ ูุฑุน</button>
                </div>
                <div id="branchesTableContainer"></div>
            </div>
        </div>

        <!-- Attendance Tab -->
        <div class="tab-content" id="attendanceTab" style="display: none;">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>โฐ ุณุฌู ุงูุญุถูุฑ ูุงูุงูุตุฑุงู</h2>
                    <button class="btn" onclick="checkOut()" style="background: #e53e3e; font-size: 16px;">๐ช ุชุณุฌูู ุงูุฎุฑูุฌ</button>
                </div>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                    <h3 style="margin: 0 0 10px;">๐ ููุชุฑุฉ ุงูุณุฌู</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                        <select id="filterAttendanceUser" onchange="loadAttendanceLog()" style="padding: 8px; border: 2px solid #cbd5e0; border-radius: 6px;">
                            <option value="">ูู ุงูููุธููู</option>
                        </select>
                        <input type="date" id="filterAttendanceDate" onchange="loadAttendanceLog()" style="padding: 8px; border: 2px solid #cbd5e0; border-radius: 6px;">
                        <button onclick="clearAttendanceFilters()" style="padding: 8px 15px; background: #dc3545; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">ูุณุญ ุงูููุงุชุฑ</button>
                    </div>
                </div>
                
                <div id="attendanceTableContainer"></div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div class="tab-content" id="settingsTab" style="display: none;">
            <div style="padding: 20px;">
                <h2>โ๏ธ ุงูุฅุนุฏุงุฏุงุช</h2>
                <div style="max-width: 600px;">
                    <div class="form-group"><label>ุงุณู ุงููุชุฌุฑ:</label><input type="text" id="storeName"></div>
                    <div class="form-group"><label>ุฑูู ุงููุงุชู:</label><input type="tel" id="storePhone"></div>
                    <div class="form-group"><label>ุงูุนููุงู:</label><input type="text" id="storeAddress"></div>
                    
                    <!-- ุงูุนููุฉ -->
                    <div class="form-group">
                        <label>ุงูุนููุฉ:</label>
                        <select id="storeCurrency" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            <option value="KWD">๐ฐ๐ผ ุฏููุงุฑ ูููุชู (KWD)</option>
                            <option value="USD">๐บ๐ธ ุฏููุงุฑ ุฃูุฑููู (USD)</option>
                            <option value="EUR">๐ช๐บ ููุฑู (EUR)</option>
                            <option value="GBP">๐ฌ๐ง ุฌููู ุฅุณุชุฑูููู (GBP)</option>
                            <option value="SAR">๐ธ๐ฆ ุฑูุงู ุณุนูุฏู (SAR)</option>
                            <option value="AED">๐ฆ๐ช ุฏุฑูู ุฅูุงุฑุงุชู (AED)</option>
                            <option value="QAR">๐ถ๐ฆ ุฑูุงู ูุทุฑู (QAR)</option>
                            <option value="OMR">๐ด๐ฒ ุฑูุงู ุนูุงูู (OMR)</option>
                            <option value="BHD">๐ง๐ญ ุฏููุงุฑ ุจุญุฑููู (BHD)</option>
                            <option value="EGP">๐ช๐ฌ ุฌููู ูุตุฑู (EGP)</option>
                            <option value="JOD">๐ฏ๐ด ุฏููุงุฑ ุฃุฑุฏูู (JOD)</option>
                            <option value="IQD">๐ฎ๐ถ ุฏููุงุฑ ุนุฑุงูู (IQD)</option>
                            <option value="LBP">๐ฑ๐ง ููุฑุฉ ูุจูุงููุฉ (LBP)</option>
                            <option value="TRY">๐น๐ท ููุฑุฉ ุชุฑููุฉ (TRY)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>ุดุนุงุฑ ุงููุชุฌุฑ (ูู ุงูููุงุชูุฑ):</label>
                        <input type="file" id="storeLogo" accept="image/*" onchange="previewLogo(this)">
                        <div id="logoPreview" style="margin-top: 10px; display: none;">
                            <img id="logoPreviewImg" style="max-width: 200px; max-height: 100px; border-radius: 8px;">
                            <button onclick="removeLogo()" class="btn-danger" style="margin-top: 10px;">ุญุฐู ุงูุดุนุงุฑ</button>
                        </div>
                    </div>
                    
                    <!-- ุฃููููุฉ ุดุงุดุฉ ุงูุฏุฎูู -->
                    <div class="form-group">
                        <label>ุฃููููุฉ ุดุงุดุฉ ุงูุฏุฎูู:</label>
                        <input type="file" id="loginIcon" accept="image/*" onchange="previewLoginIcon(this)">
                        <div id="loginIconPreview" style="margin-top: 10px; display: none;">
                            <img id="loginIconPreviewImg" style="max-width: 150px; max-height: 150px; border-radius: 50%; border: 4px solid #667eea;">
                            <button onclick="removeLoginIcon()" class="btn-danger" style="margin-top: 10px;">ุงุณุชุนุงุฏุฉ ุงูุฃููููุฉ ุงูุงูุชุฑุงุถูุฉ</button>
                        </div>
                        <p style="font-size: 12px; color: #666; margin-top: 5px;">* ุงูุฃููููุฉ ุงูุงูุชุฑุงุถูุฉ: ๐๏ธ</p>
                    </div>
                    
                    <button onclick="saveSettings()" class="btn">ุญูุธ</button>
                </div>

                <!-- ุฅุนุฏุงุฏุงุช ูุถุน ุงูุชุฒุงูู -->
                <div style="max-width: 600px; margin-top: 30px;">
                    <h3 style="color: #0ea5e9; margin-bottom: 15px;">๐ ุฅุนุฏุงุฏุงุช ุงูุชุฒุงูู</h3>
                    <div style="background: #f0f4ff; padding: 20px; border-radius: 12px; border: 2px solid #667eea;">
                        <div class="form-group">
                            <label>ูุถุน ุงูุชุดุบูู:</label>
                            <select id="syncModeSelect" onchange="onSyncModeChange()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                                <option value="local">ูุญูู ุจุงููุงูู - ุจุฏูู ุณูุฑูุฑ ุฎุงุฑุฌู</option>
                                <option value="server">ุชุฒุงูู ูุน ุณูุฑูุฑ ุฎุงุฑุฌู</option>
                            </select>
                            <p style="font-size: 12px; color: #666; margin-top: 5px;">ุงููุญูู: ูู ุงูุจูุงูุงุช ุชุจูู ูู ุฌูุงุฒู ููุท | ุงูุณูุฑูุฑ: ุชุฒุงูู ุงูุจูุงูุงุช ูุน ุณูุฑูุฑ ูุฑูุฒู</p>
                        </div>

                        <!-- ุฅุนุฏุงุฏุงุช ุงูุณูุฑูุฑ - ุชุธูุฑ ููุท ุนูุฏ ุงุฎุชูุงุฑ ูุถุน ุงูุณูุฑูุฑ -->
                        <div id="serverSyncSettings" style="display: none; margin-top: 15px; padding-top: 15px; border-top: 2px solid #e2e8f0;">
                            <div class="form-group">
                                <label>ุนููุงู ุงูุณูุฑูุฑ:</label>
                                <select id="syncServerPreset" onchange="onSyncServerPresetChange()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                                    <option value="">-- ุงุฎุชุฑ ุณูุฑูุฑ --</option>
                                    <option value="https://pos.example.com">pos.example.com (ุฑุฆูุณู)</option>
                                    <option value="custom">ุฅุฏุฎุงู ุนููุงู ูุฎุตุต...</option>
                                </select>
                            </div>
                            <div id="customServerUrlGroup" class="form-group" style="display: none;">
                                <label>ุนููุงู ูุฎุตุต:</label>
                                <input type="url" id="syncCustomServerUrl" placeholder="https://my-server.com" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%; direction: ltr; text-align: left;">
                                <p style="font-size: 12px; color: #666; margin-top: 5px;">ุฃุฏุฎู ุงูุนููุงู ุงููุงูู ูุน https://</p>
                            </div>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px;">
                                <button onclick="saveSyncModeSettings()" class="btn" style="background: #667eea;">๐พ ุญูุธ ุฅุนุฏุงุฏุงุช ุงูุชุฒุงูู</button>
                                <button onclick="testSyncServer()" class="btn" style="background: #06b6d4;">๐ ุงุฎุชุจุงุฑ ุงูุงุชุตุงู</button>
                                <button id="syncNowSettingsBtn" onclick="syncNowFromSettings()" class="btn" style="background: #38a169;">๐ ูุฒุงููุฉ ุงูุขู</button>
                            </div>
                            <div id="syncServerTestResult" style="margin-top: 10px; padding: 10px; border-radius: 8px; display: none;"></div>
                            <div id="syncNowResult" style="margin-top: 10px; padding: 12px; border-radius: 8px; display: none; font-size: 13px;"></div>
                        </div>

                        <!-- ุฅุนุฏุงุฏุงุช ุงููุฒุงููุฉ ุงูุชููุงุฆูุฉ -->
                        <div style="margin-top: 15px; padding-top: 15px; border-top: 2px solid #e2e8f0;">
                            <div class="form-group" style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                                <label style="margin: 0; white-space: nowrap;">โฑ๏ธ ุงููุฒุงููุฉ ุงูุชููุงุฆูุฉ ูู:</label>
                                <select id="autoSyncIntervalSelect" onchange="saveAutoSyncInterval()" style="padding: 8px; border: 2px solid #cbd5e0; border-radius: 6px; width: auto;">
                                    <option value="1">1 ุฏูููุฉ</option>
                                    <option value="2">2 ุฏูููุฉ</option>
                                    <option value="3">3 ุฏูุงุฆู</option>
                                    <option value="5" selected>5 ุฏูุงุฆู</option>
                                    <option value="10">10 ุฏูุงุฆู</option>
                                    <option value="15">15 ุฏูููุฉ</option>
                                    <option value="30">30 ุฏูููุฉ</option>
                                    <option value="60">60 ุฏูููุฉ</option>
                                </select>
                                <span id="autoSyncNextRun" style="font-size: 12px; color: #666;"></span>
                            </div>
                        </div>

                        <!-- ุญุงูุฉ ุงููุถุน ุงูุญุงูู -->
                        <div id="syncModeStatus" style="margin-top: 15px; padding: 12px; border-radius: 8px; background: #e6fffa; border: 1px solid #81e6d9;">
                            <span id="syncModeStatusText" style="font-size: 13px; color: #2d3748;">ุงููุถุน ุงูุญุงูู: ูุญูู ุจุงููุงูู</span>
                        </div>
                    </div>
                </div>

                <!-- ุฅุนุฏุงุฏุงุช ุชูุจูู ุงููุฎุฒูู ุงูููุฎูุถ -->
                <div style="max-width: 600px; margin-top: 30px;">
                    <h3 style="color: #e53e3e; margin-bottom: 15px;">๐ฆ ุฅุนุฏุงุฏุงุช ุชูุจูู ุงููุฎุฒูู</h3>
                    <div style="background: #fff5f5; padding: 20px; border-radius: 12px; border: 2px solid #fc8181;">
                        <div class="form-group">
                            <label>ุญุฏ ุงููุฎุฒูู ุงูููุฎูุถ:</label>
                            <input type="number" id="lowStockThreshold" min="1" value="5" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            <p style="font-size: 12px; color: #666; margin-top: 5px;">ุนูุฏูุง ูุตู ูุฎุฒูู ุงูููุชุฌ ููุฐุง ุงูุฑูู ุฃู ุฃููุ ุณูุธูุฑ ุชูุจูู ุชููุงุฆู</p>
                        </div>
                        <button onclick="saveLowStockSettings()" class="btn" style="background: #e53e3e;">๐พ ุญูุธ ุฅุนุฏุงุฏุงุช ุงููุฎุฒูู</button>
                    </div>
                </div>

                <!-- ุฅุนุฏุงุฏุงุช ููุงุท ุงูููุงุก -->
                <div style="max-width: 600px; margin-top: 30px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">๐ ุฅุนุฏุงุฏุงุช ููุงุท ุงูููุงุก</h3>
                    <div style="background: #f0f9ff; padding: 20px; border-radius: 12px; border: 2px solid #0ea5e9;">
                        <div class="form-group">
                            <label>ุชูุนูู ูุธุงู ุงูููุงุก:</label>
                            <select id="loyaltyEnabled" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                                <option value="true">ููุนู</option>
                                <option value="false">ูุนุทู</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ุนุฏุฏ ุงูููุงุท ููู ูุงุชูุฑุฉ:</label>
                            <input type="number" id="loyaltyPointsPerInvoice" min="1" value="10" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            <p style="font-size: 12px; color: #666; margin-top: 5px;">ูุซุงู: 10 ูุนูู ูู ูุงุชูุฑุฉ ูุญุตู ุงูุนููู ุนูู 10 ููุงุท</p>
                        </div>
                        <div class="form-group">
                            <label>ูููุฉ ุงูููุทุฉ ุงููุงุญุฏุฉ ุจุงูุฏููุงุฑ:</label>
                            <input type="number" id="loyaltyPointValue" min="0.001" step="0.001" value="0.100" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                            <p style="font-size: 12px; color: #666; margin-top: 5px;">ูุซุงู: 0.100 ูุนูู ูู ููุทุฉ = 0.100 ุฏ.ู ุฎุตู</p>
                        </div>
                        <div id="loyaltyPreview" style="background: #fff; padding: 15px; border-radius: 8px; margin: 15px 0; border: 2px solid #e2e8f0;">
                            <h4 style="margin: 0 0 10px; color: #0369a1;">๐ ูุนุงููุฉ ุงููุธุงู:</h4>
                            <div id="loyaltyPreviewText" style="font-size: 14px; line-height: 2;"></div>
                        </div>
                        <button onclick="saveLoyaltySettings()" class="btn" style="background: #0ea5e9;">๐พ ุญูุธ ุฅุนุฏุงุฏุงุช ุงูููุงุก</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Backup Tab -->
        <div class="tab-content" id="backupTab" style="display: none;">
            <div style="padding: 20px;">
                <h2>๐พ ุงููุณุฎ ุงูุงุญุชูุงุทู</h2>

                <!-- ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 25px; border-radius: 16px; margin-bottom: 25px; color: white;">
                    <h3 style="margin: 0 0 15px; font-size: 20px;">๐ฆ ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ</h3>
                    <p style="opacity: 0.9; margin-bottom: 20px;">ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุงููุฉ ุชุดูู ุงูููุชุฌุงุชุ ุงูููุงุชูุฑุ ุงูุนููุงุกุ ูุงูุฅุนุฏุงุฏุงุช.</p>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button onclick="createBackup()" class="btn" style="background: rgba(255,255,255,0.2); border: 2px solid white; color: white; padding: 12px 25px; font-size: 16px;">
                            ๐พ ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุงูุขู
                        </button>
                        <button onclick="createAndUploadGDrive()" class="btn" id="backupToGDriveBtn" style="background: rgba(255,255,255,0.2); border: 2px solid #34a853; color: white; padding: 12px 25px; font-size: 16px; display: none;">
                            โ๏ธ ูุณุฎ ุงุญุชูุงุทู ุฅูู Google Drive
                        </button>
                    </div>
                    <div id="backupProgress" style="display: none; margin-top: 15px; background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div class="spinner" style="border: 3px solid rgba(255,255,255,0.3); border-top: 3px solid white; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite;"></div>
                            <span id="backupProgressText">ุฌุงุฑู ุฅูุดุงุก ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ...</span>
                        </div>
                    </div>
                </div>

                <!-- ุงุณุชุนุงุฏุฉ ูุณุฎุฉ ุงุญุชูุงุทูุฉ -->
                <div style="background: #fff3cd; padding: 20px; border-radius: 16px; margin-bottom: 25px; border: 2px solid #ffc107;">
                    <h3 style="margin: 0 0 15px; color: #856404;">๐ ุงุณุชุนุงุฏุฉ ูุณุฎุฉ ุงุญุชูุงุทูุฉ</h3>
                    <p style="color: #856404; margin-bottom: 15px;">ุฑูุน ููู ูุณุฎุฉ ุงุญุชูุงุทูุฉ (.db) ูุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุช. ุณูุชู ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุชููุงุฆูุฉ ูุจู ุงูุงุณุชุนุงุฏุฉ.</p>
                    <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                        <input type="file" id="restoreFileInput" accept=".db" style="flex: 1; min-width: 200px; padding: 10px; border: 2px dashed #ffc107; border-radius: 8px; background: white;">
                        <button onclick="restoreBackup()" class="btn" style="background: #e67e00; padding: 12px 25px;">๐ ุงุณุชุนุงุฏุฉ</button>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">
                    <!-- ุงููุณุฎ ุงููุญููุฉ -->
                    <div style="min-width: 0;">
                        <h3 style="color: #4a5568; margin-bottom: 15px;">๐ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ุงููุญููุฉ</h3>
                        <div id="backupsList" style="background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden;">
                            <div style="padding: 30px; text-align: center; color: #a0aec0;">ุฌุงุฑู ุงูุชุญููู...</div>
                        </div>
                    </div>

                    <!-- ุงููุณุฎ ูู Google Drive -->
                    <div style="min-width: 0;">
                        <h3 style="color: #4a5568; margin-bottom: 15px;">โ๏ธ ุงููุณุฎ ูู Google Drive</h3>
                        <div id="gdriveFilesList" style="background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden;">
                            <div style="padding: 30px; text-align: center; color: #a0aec0;">ุบูุฑ ูุชุตู ุจู Google Drive</div>
                        </div>
                    </div>
                </div>

                <!-- ุฅุนุฏุงุฏุงุช ุงูุฌุฏููุฉ -->
                <div style="background: white; padding: 25px; border-radius: 16px; margin-top: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="color: #667eea; margin: 0 0 20px;">โฐ ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุชููุงุฆู</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                        <div class="form-group">
                            <label>ุชูุนูู ุงููุณุฎ ุงูุชููุงุฆู:</label>
                            <select id="backupScheduleEnabled" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                                <option value="false">ูุนุทู</option>
                                <option value="true">ููุนู</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ููุช ุงููุณุฎ ุงููููู:</label>
                            <input type="time" id="backupScheduleTime" value="03:00" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                        </div>
                        <div class="form-group">
                            <label>ุงูุงุญุชูุงุธ ุจุงููุณุฎ (ุฃูุงู):</label>
                            <input type="number" id="backupKeepDays" value="30" min="1" max="365" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                        </div>
                        <div class="form-group">
                            <label>ุฑูุน ุชููุงุฆู ูู Google Drive:</label>
                            <select id="backupGDriveAuto" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                                <option value="false">ูุนุทู</option>
                                <option value="true">ููุนู</option>
                            </select>
                        </div>
                    </div>
                    <button onclick="saveBackupSchedule()" class="btn" style="margin-top: 15px; padding: 12px 30px;">๐พ ุญูุธ ุฅุนุฏุงุฏุงุช ุงูุฌุฏููุฉ</button>
                </div>

                <!-- ุฑุจุท Google Drive -->
                <div style="background: white; padding: 25px; border-radius: 16px; margin-top: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="color: #4285f4; margin: 0 0 20px;">
                        <span style="display: inline-flex; align-items: center; gap: 8px;">
                            โ๏ธ ุฑุจุท Google Drive
                            <span id="gdriveStatusBadge" style="font-size: 12px; padding: 3px 10px; border-radius: 20px; background: #fee2e2; color: #ef4444;">ุบูุฑ ูุชุตู</span>
                        </span>
                    </h3>

                    <!-- ุฎุทูุงุช ุงูุฑุจุท -->
                    <div id="gdriveSetupSection">
                        <div style="background: #f0f9ff; padding: 15px; border-radius: 10px; margin-bottom: 20px; border-right: 4px solid #4285f4;">
                            <strong>๐ ุฎุทูุงุช ุงูุฅุนุฏุงุฏ:</strong>
                            <ol style="margin: 10px 0 0 0; padding-right: 20px; line-height: 2;">
                                <li>ุงูุชูู ุฅูู <a href="https://console.cloud.google.com/" target="_blank" style="color: #4285f4;">Google Cloud Console</a></li>
                                <li>ุฃูุดุฆ ูุดุฑูุนุงู ุฌุฏูุฏุงู ููุนูู Google Drive API</li>
                                <li>ุฃูุดุฆ OAuth 2.0 Credentials (ููุน <strong>Web Application</strong>)</li>
                                <li>ุฃุถู Redirect URI ุงููุนุฑูุถ ุฃุฏูุงู ุจุนุฏ ุงูุถุบุท ุนูู ุฒุฑ ุงูุชูููุถ</li>
                                <li>ุฃุฏุฎู Client ID ู Client Secret ุฃุฏูุงู</li>
                            </ol>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                            <div class="form-group">
                                <label>Client ID:</label>
                                <input type="text" id="gdriveClientId" placeholder="xxxx.apps.googleusercontent.com" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%; direction: ltr;">
                            </div>
                            <div class="form-group">
                                <label>Client Secret:</label>
                                <input type="password" id="gdriveClientSecret" placeholder="GOCSPX-xxxx" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%; direction: ltr;">
                            </div>
                        </div>

                        <button onclick="gdriveStartAuth()" class="btn" style="background: #4285f4; padding: 12px 25px; margin-bottom: 15px;">๐ ุงูุญุตูู ุนูู ุฑุงุจุท ุงูุชูููุถ</button>

                        <div id="gdriveRedirectUriSection" style="display: none; margin-top: 15px;">
                            <div style="background: #fffbeb; padding: 15px; border-radius: 10px; border-right: 4px solid #f59e0b; margin-bottom: 15px;">
                                <strong>โ๏ธ ููู:</strong> ุฃุถู ูุฐุง ุงูุฑุงุจุท ูู <strong>Authorized redirect URI</strong> ูู Google Cloud Console:
                                <div style="background: #fef3c7; padding: 10px; border-radius: 6px; margin-top: 8px; direction: ltr; font-family: monospace; font-size: 14px; word-break: break-all; cursor: pointer;" onclick="navigator.clipboard.writeText(this.textContent).then(()=>alert('ุชู ุงููุณุฎ!'))" title="ุงุถุบุท ูููุณุฎ">
                                    <span id="gdriveRedirectUriDisplay"></span>
                                </div>
                                <small style="color: #92400e; margin-top: 5px; display: block;">ุงุถุบุท ุนูู ุงูุฑุงุจุท ููุณุฎู - ุซู ุฃุถูู ูู Google Cloud Console ูุจู ุงูููุงููุฉ</small>
                            </div>
                        </div>

                        <div id="gdriveAuthCodeSection" style="display: none; margin-top: 15px;">
                            <div style="background: #f0fdf4; padding: 15px; border-radius: 10px; border-right: 4px solid #22c55e; margin-bottom: 15px;">
                                <strong>โ ุชู ูุชุญ ูุงูุฐุฉ ุงูุชูููุถ.</strong> ุจุนุฏ ุงูููุงููุฉ ุณูุชู ุงูุฑุจุท ุชููุงุฆูุงู. ุฅุฐุง ูู ูุนูู ุชููุงุฆูุงูุ ุงูุณุฎ ุงูููุฏ ูู ุงูุฑุงุจุท ูุงูุตูู ููุง:
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <input type="text" id="gdriveAuthCode" placeholder="ุงูุตู ููุฏ ุงูุชูููุถ ููุง (ุงุฎุชูุงุฑู)" style="flex: 1; padding: 10px; border: 2px solid #22c55e; border-radius: 6px; direction: ltr;">
                                <button onclick="gdriveConnect()" class="btn" style="background: #22c55e; padding: 12px 25px;">โ ุฑุจุท</button>
                            </div>
                        </div>
                    </div>

                    <!-- ุญุงูุฉ ุงูุงุชุตุงู -->
                    <div id="gdriveConnectedSection" style="display: none;">
                        <div style="background: #f0fdf4; padding: 20px; border-radius: 10px; border: 2px solid #22c55e; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <span style="font-size: 24px;">โ</span>
                                <strong style="color: #16a34a; font-size: 18px; margin-right: 10px;">Google Drive ูุชุตู</strong>
                                <p style="color: #4ade80; margin: 5px 0 0;">ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ุณุชุฑูุน ุชููุงุฆูุงู ุฅูู ูุฌูุฏ POS-Backups</p>
                            </div>
                            <button onclick="gdriveDisconnect()" class="btn" style="background: #ef4444; padding: 10px 20px;">ูุทุน ุงูุงุชุตุงู</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Dashboard Tab -->
        <div class="tab-content" id="admindashboardTab" style="display: none;">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; flex-wrap: wrap; gap: 10px;">
                    <h2 style="margin: 0; color: #1a202c;">ุดุงุดุฉ ุงูุฃุฏูู - ูุฑุงูุจุฉ ุงูุดุฑูุฉ</h2>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                        <button onclick="loadAdminDashboard()" class="btn" style="background: #667eea; padding: 10px 20px; border-radius: 8px; color: white; border: none; cursor: pointer;">ุชุญุฏูุซ ุงูุจูุงูุงุช</button>
                    </div>
                </div>

                <!-- ูุณู ุงููุฒุงููุฉ - ููุฃุฏูู ููุท -->
                <div id="syncSection" style="background: linear-gradient(135deg, #1e293b, #334155); border-radius: 16px; padding: 25px; margin-bottom: 25px; color: white;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                        <div>
                            <h3 style="margin: 0 0 5px; font-size: 18px;">ูุฑูุฒ ุงููุฒุงููุฉ</h3>
                            <p id="syncStatusText" style="margin: 0; font-size: 13px; opacity: 0.8;">ูู ูุชู ุงููุฒุงููุฉ ุจุนุฏ</p>
                            <p id="syncProgressText" style="margin: 4px 0 0; font-size: 12px; opacity: 0.7;"></p>
                        </div>
                        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                            <button id="manualSyncBtn" onclick="manualSync()" style="background: linear-gradient(135deg, #10b981, #059669); color: white; border: none; padding: 12px 24px; border-radius: 10px; cursor: pointer; font-size: 14px; font-weight: bold; transition: all 0.3s;">ูุฒุงููุฉ ูุฏููุฉ</button>
                            <button id="fullSyncBtn" onclick="fullSync()" style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white; border: none; padding: 12px 24px; border-radius: 10px; cursor: pointer; font-size: 14px; font-weight: bold;">ูุฒุงููุฉ ูุงููุฉ</button>
                        </div>
                    </div>

                    <!-- ุฅุญุตุงุฆูุงุช ุงููุฒุงููุฉ -->
                    <div id="syncStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px;">
                        <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 24px; font-weight: bold;" id="syncStatPendingInv">0</div>
                            <div style="font-size: 12px; opacity: 0.8;">ููุงุชูุฑ ูุนููุฉ</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 24px; font-weight: bold;" id="syncStatPendingCust">0</div>
                            <div style="font-size: 12px; opacity: 0.8;">ุนููุงุก ูุนูููู</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 24px; font-weight: bold;" id="syncStatProducts">0</div>
                            <div style="font-size: 12px; opacity: 0.8;">ููุชุฌ ูุญูู</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 24px; font-weight: bold;" id="syncStatCustomers">0</div>
                            <div style="font-size: 12px; opacity: 0.8;">ุนููู ูุญูู</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 24px; font-weight: bold;" id="syncStatLocalInv">0</div>
                            <div style="font-size: 12px; opacity: 0.8;">ูุงุชูุฑุฉ ูุญููุฉ</div>
                        </div>
                    </div>

                    <!-- ุณุฌู ุงููุฒุงููุฉ -->
                    <div style="margin-top: 15px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; cursor: pointer;" onclick="toggleSyncLog()">
                            <h4 style="margin: 0; font-size: 14px; opacity: 0.9;">ุณุฌู ุงููุฒุงููุฉ</h4>
                            <span id="syncLogToggle" style="font-size: 12px; opacity: 0.7;">ุนุฑุถ</span>
                        </div>
                        <div id="syncLogContainer" style="display: none; margin-top: 10px; max-height: 200px; overflow-y: auto; background: rgba(0,0,0,0.2); border-radius: 8px; padding: 10px;">
                            <div id="syncLogList" style="font-size: 12px; opacity: 0.8;">ูุง ููุฌุฏ ุณุฌูุงุช</div>
                        </div>
                    </div>

                    <!-- ูุถุน ุงูุชุฒุงูู ุงูุญุงูู -->
                    <div style="margin-top: 15px; background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px;">
                        <h4 style="margin: 0 0 10px; font-size: 14px;">ูุถุน ุงูุชุฒุงูู</h4>
                        <div id="adminSyncModeInfo" style="font-size: 13px; opacity: 0.9; margin-bottom: 10px;">ูุญูู ุจุงููุงูู</div>
                        <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
                            <input type="text" id="serverUrlInput" placeholder="ุฑุงุจุท ุงูุณูุฑูุฑ (ูุซุงู: https://pos.example.com)" value="" style="flex: 1; min-width: 200px; padding: 10px; border-radius: 8px; border: none; font-size: 13px; direction: ltr;">
                            <button onclick="saveServerUrl()" style="background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 13px;">ุญูุธ</button>
                            <button onclick="testServerConnection()" style="background: #06b6d4; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 13px;">ุงุฎุชุจุงุฑ ุงูุงุชุตุงู</button>
                        </div>
                        <p style="font-size: 11px; opacity: 0.6; margin-top: 8px;">ูุชุบููุฑ ูุถุน ุงูุชุฒุงูู (ูุญูู/ุณูุฑูุฑ) ุงุฐูุจ ุฅูู ุงูุฅุนุฏุงุฏุงุช</p>
                        <div id="serverTestResult" style="margin-top: 8px; font-size: 12px; opacity: 0.8;"></div>
                    </div>
                </div>

                <!-- ุฅุญุตุงุฆูุงุช ุนุงูุฉ -->
                <div id="adminDashOverallStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;"></div>

                <!-- ููุฎุต ุงูููุงุชูุฑ ููู ูุฑุน -->
                <div style="background: white; border-radius: 16px; box-shadow: 0 2px 12px rgba(0,0,0,0.08); padding: 25px; margin-bottom: 25px;">
                    <h3 style="margin: 0 0 20px; color: #2d3748; font-size: 18px;">ุงูููุงุชูุฑ ุญุณุจ ุงููุฑูุน</h3>
                    <div id="adminDashInvoicesTable" style="overflow-x: auto;">
                        <div style="padding: 30px; text-align: center; color: #a0aec0;">ุฌุงุฑู ุงูุชุญููู...</div>
                    </div>
                </div>

                <!-- ููุฎุต ุงููุฎุฒูู ููู ูุฑุน -->
                <div style="background: white; border-radius: 16px; box-shadow: 0 2px 12px rgba(0,0,0,0.08); padding: 25px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0; color: #2d3748; font-size: 18px;">ุงููุฎุฒูู ุญุณุจ ุงููุฑูุน</h3>
                        <input type="text" id="adminDashStockSearch" placeholder="ุงุจุญุซ ุนู ููุชุฌ..." oninput="filterAdminDashStock()" style="padding: 8px 15px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; width: 250px;">
                    </div>
                    <div id="adminDashStockTable" style="overflow-x: auto;">
                        <div style="padding: 30px; text-align: center; color: #a0aec0;">ุฌุงุฑู ุงูุชุญููู...</div>
                    </div>
                </div>

                <!-- ุฃุฏุงุก ุงูุดูุชุงุช -->
                <div style="background: white; border-radius: 16px; box-shadow: 0 2px 12px rgba(0,0,0,0.08); padding: 25px; margin-top: 25px;">
                    <h3 style="margin: 0 0 20px; color: #2d3748; font-size: 18px;">ุฃุฏุงุก ุงูุดูุชุงุช</h3>
                    <div id="adminDashShiftPerformance" style="overflow-x: auto;">
                        <div style="padding: 30px; text-align: center; color: #a0aec0;">ุฌุงุฑู ุงูุชุญููู...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Expenses Tab -->
        <div class="tab-content" id="expensesTab" style="display: none;">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>๐ฐ ุงูุชูุงููู</h2>
                    <button onclick="showAddExpense()" class="add-btn">โ ุฅุถุงูุฉ ุชูููุฉ</button>
                </div>
                
                <div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div class="form-group">
                            <label>ูู ุชุงุฑูุฎ:</label>
                            <input type="date" id="expenseStartDate">
                        </div>
                        <div class="form-group">
                            <label>ุฅูู ุชุงุฑูุฎ:</label>
                            <input type="date" id="expenseEndDate">
                        </div>
                        <div class="form-group">
                            <label>ุงููุฑุน:</label>
                            <select id="expenseBranchFilter">
                                <option value="">ูู ุงููุฑูุน</option>
                            </select>
                        </div>
                        <div style="display: flex; align-items: flex-end;">
                            <button onclick="loadExpenses()" class="btn">ุนุฑุถ</button>
                        </div>
                    </div>
                </div>
                
                <div id="expensesContainer"></div>
            </div>
        </div>

        <!-- Advanced Reports Tab -->
        <div class="tab-content" id="advancedreportsTab" style="display: none;">
            <div style="padding: 20px;">
                <h2>๐ ุงูุชูุงุฑูุฑ ุงููุชูุฏูุฉ</h2>
                
                <div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div class="form-group">
                            <label>ูู ุชุงุฑูุฎ:</label>
                            <input type="date" id="advReportStartDate">
                        </div>
                        <div class="form-group">
                            <label>ุฅูู ุชุงุฑูุฎ:</label>
                            <input type="date" id="advReportEndDate">
                        </div>
                        <div class="form-group">
                            <label>ุงููุฑุน:</label>
                            <select id="advReportBranchFilter">
                                <option value="">ูู ุงููุฑูุน</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 15px; margin-bottom: 30px; flex-wrap: wrap;">
                    <button onclick="loadProductReport()" class="btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); flex: 1; min-width: 200px; padding: 15px;">๐ฆ ุงููุจูุนุงุช ุญุณุจ ุงูููุชุฌ</button>
                    <button onclick="loadBranchReport()" class="btn" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); flex: 1; min-width: 200px; padding: 15px;">๐ข ุงููุจูุนุงุช ุญุณุจ ุงููุฑุน</button>
                    <button onclick="loadProfitLossReport()" class="btn" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); flex: 1; min-width: 200px; padding: 15px;">๐ฐ ุงูุฑุจุญ ูุงูุฎุณุงุฑุฉ</button>
                </div>
                
                <div id="advancedReportContent"></div>
            </div>
        </div>
    </div>

        <!-- Coupons Tab -->
        <div class="tab-content" id="couponsTab" style="display: none;">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>๐๏ธ ุงูููุจููุงุช</h2>
                    <button onclick="showAddCoupon()" class="add-btn">โ ุฅุถุงูุฉ ููุจูู</button>
                </div>
                <div id="couponsStatsContainer" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;"></div>
                <div id="couponsContainer"></div>
            </div>
        </div>

        <!-- Tables Tab -->
        <div class="tab-content" id="tablesTab" style="display: none;">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>๐ฝ๏ธ ุทุงููุงุช ุงููุทุนู</h2>
                    <button onclick="showAddTable()" class="add-btn">โ ุฅุถุงูุฉ ุทุงููุฉ</button>
                </div>
                <div id="tablesStatsContainer" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 20px;"></div>
                <div id="tablesFloorPlan" style="position: relative; min-height: 500px; background: #f8fafc; border: 2px dashed #cbd5e1; border-radius: 16px; overflow: hidden;"></div>
            </div>
        </div>

    <!-- Add Table Modal -->
    <div class="modal" id="addTableModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2 id="tableModalTitle">โ ุฅุถุงูุฉ ุทุงููุฉ</h2>
                <button onclick="closeAddTable()" class="close-btn">&times;</button>
            </div>
            <form id="tableForm">
                <input type="hidden" id="tableId">
                <div class="form-group">
                    <label>ุงุณู ุงูุทุงููุฉ:</label>
                    <input type="text" id="tableName" required placeholder="ูุซุงู: ุทุงููุฉ 1">
                </div>
                <div class="form-group">
                    <label>ุนุฏุฏ ุงูููุงุนุฏ:</label>
                    <input type="number" id="tableSeats" min="1" value="4">
                </div>
                <button type="submit" class="btn" style="width: 100%; padding: 12px;">๐พ ุญูุธ</button>
            </form>
        </div>
    </div>

    <!-- Table Invoice Modal -->
    <div class="modal" id="tableInvoiceModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 id="tableInvoiceTitle">๐ฝ๏ธ ูุงุชูุฑุฉ ุงูุทุงููุฉ</h2>
                <button onclick="document.getElementById('tableInvoiceModal').classList.remove('active')" class="close-btn">&times;</button>
            </div>
            <div id="tableInvoiceContent"></div>
        </div>
    </div>

    <!-- Super Admin Settings Modal -->
    <div class="modal" id="superAdminSettingsModal">
        <div class="modal-content" style="max-width: 450px;">
            <div class="modal-header">
                <h2>โ๏ธ ุฅุนุฏุงุฏุงุช ุงููุฏูุฑ ุงูุฃุนูู</h2>
                <button onclick="document.getElementById('superAdminSettingsModal').classList.remove('active')" class="close-btn">&times;</button>
            </div>
            <form id="superAdminSettingsForm" style="padding: 5px;">
                <div class="form-group">
                    <label>ุงูุงุณู ุงููุงูู:</label>
                    <input type="text" id="saSettingsFullName" required>
                </div>
                <div class="form-group">
                    <label>ุงุณู ุงููุณุชุฎุฏู ุงูุฌุฏูุฏ:</label>
                    <input type="text" id="saSettingsUsername" required style="direction: ltr;">
                </div>
                <hr style="border: 1px solid #e5e7eb; margin: 15px 0;">
                <div class="form-group">
                    <label>ูููุฉ ุงููุฑูุฑ ุงูุญุงููุฉ: <span style="color: #ef4444;">*</span></label>
                    <input type="password" id="saSettingsOldPassword" required placeholder="ูุทููุจ ููุชุฃููุฏ">
                </div>
                <div class="form-group">
                    <label>ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ: <small style="color: #94a3b8;">(ุงุชุฑููุง ูุงุฑุบุฉ ูุนุฏู ุงูุชุบููุฑ)</small></label>
                    <input type="password" id="saSettingsNewPassword" placeholder="ุงุชุฑููุง ูุงุฑุบุฉ ุฅุฐุง ูุง ุชุฑูุฏ ุงูุชุบููุฑ">
                </div>
                <div class="form-group">
                    <label>ุชุฃููุฏ ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ:</label>
                    <input type="password" id="saSettingsConfirmPassword" placeholder="ุฃุนุฏ ูุชุงุจุฉ ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ">
                </div>
                <button type="submit" class="btn" style="width: 100%; padding: 12px; background: linear-gradient(135deg, #8b5cf6, #7c3aed); color: white;">๐พ ุญูุธ ุงูุชุบููุฑุงุช</button>
            </form>
        </div>
    </div>

    <!-- Add/Edit Coupon Modal -->
    <div class="modal" id="addCouponModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="couponModalTitle">โ ุฅุถุงูุฉ ููุจูู</h2>
                <button onclick="closeAddCoupon()" class="close-btn">&times;</button>
            </div>
            <form id="couponForm">
                <input type="hidden" id="couponId">
                <div class="form-group">
                    <label>ููุฏ ุงูููุจูู:</label>
                    <input type="text" id="couponCode" required style="text-transform: uppercase;" placeholder="ูุซุงู: SALE20">
                </div>
                <div class="form-group">
                    <label>ููุน ุงูุฎุตู:</label>
                    <select id="couponDiscountType" required>
                        <option value="percent">ูุณุจุฉ ูุฆููุฉ (%)</option>
                        <option value="fixed">ูุจูุบ ุซุงุจุช (ุฏ.ู)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ูููุฉ ุงูุฎุตู:</label>
                    <input type="number" id="couponDiscountValue" step="0.001" min="0" required>
                </div>
                <div class="form-group">
                    <label>ุงูุญุฏ ุงูุฃุฏูู ููุทูุจ (ุฏ.ู):</label>
                    <input type="number" id="couponMinAmount" step="0.001" min="0" value="0">
                </div>
                <div class="form-group">
                    <label>ุงูุญุฏ ุงูุฃูุตู ููุงุณุชุฎุฏุงู (0 = ุบูุฑ ูุญุฏูุฏ):</label>
                    <input type="number" id="couponMaxUses" min="0" value="0">
                </div>
                <div class="form-group">
                    <label>ุชุงุฑูุฎ ุงูุงูุชูุงุก:</label>
                    <input type="date" id="couponExpiryDate">
                </div>
                <button type="submit" class="btn" style="width: 100%; padding: 12px;">๐พ ุญูุธ</button>
            </form>
        </div>
    </div>

    <!-- Add Inventory Modal -->
    <div class="modal" id="addInventoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="inventoryModalTitle">โ ุฅุถุงูุฉ ููุชุฌ ูููุฎุฒูู</h2>
                <button class="close-btn" onclick="closeAddInventory()">โ๏ธ</button>
            </div>
            <div class="modal-body">
                <form id="inventoryForm">
                    <input type="hidden" id="inventoryId">
                    <div class="form-group"><label>ุงุณู ุงูููุชุฌ:</label><input type="text" id="inventoryName" required></div>
                    <div class="form-group"><label>ุงูุจุงุฑููุฏ:</label><input type="text" id="inventoryBarcode"></div>
                    <div class="form-group"><label>ุงูุณุนุฑ (ุฏ.ู):</label><input type="number" id="inventoryPrice" step="0.001" required oninput="calculateInventoryProfit()"></div>
                    
                    <!-- ูุธุงู ุงูุชูุงููู ุงูุชูุตููู -->
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin: 15px 0; border: 2px solid #667eea;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h4 style="color: #667eea; margin: 0;">๐ฐ ุงูุชูุงููู ุงูุชูุตูููุฉ</h4>
                            <button type="button" onclick="addInventoryCostRow()" class="btn" style="background: #38a169; padding: 8px 16px; font-size: 14px;">
                                โ ุฅุถุงูุฉ ุชูููุฉ
                            </button>
                        </div>
                        
                        <div id="inventoryCostsContainer">
                            <!-- ุงูุชูุงููู ุชุถุงู ููุง -->
                        </div>
                        
                        <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 15px; border: 2px solid #667eea;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span style="font-weight: bold; color: #2d3748; font-size: 16px;">๐ต ุฅุฌูุงูู ุงูุชูููุฉ:</span>
                                <span id="inventoryTotalCostDisplay" style="font-size: 24px; font-weight: bold; color: #667eea;">0.000 ุฏ.ู</span>
                            </div>
                        </div>
                        
                        <div style="background: #fff3cd; padding: 12px; border-radius: 8px; margin-top: 15px; border-right: 4px solid #ffc107;">
                            <strong>๐ ูุงูุด ุงูุฑุจุญ:</strong>
                            <div style="margin-top: 5px; font-size: 18px; font-weight: bold; color: #2d3748;" id="inventoryProfitDisplay">
                                --
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group" style="display: none;"><label>ุงูุชูููุฉ (ุฏ.ู):</label><input type="number" id="inventoryCost" step="0.001" readonly></div>

                    <!-- ูุธุงู ุงูุฎุตุงุฆุต/ุงููุชุบูุฑุงุช -->
                    <div style="background: #f0fff4; padding: 20px; border-radius: 12px; margin: 15px 0; border: 2px solid #38a169;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h4 style="color: #38a169; margin: 0;">๐ ุฎุตุงุฆุต ุงูููุชุฌ (ููุงุณุงุช / ุฃุญุฌุงู / ุฃูุฒุงู)</h4>
                            <button type="button" onclick="addVariantRow()" class="btn" style="background: #38a169; padding: 8px 16px; font-size: 14px;">
                                โ ุฅุถุงูุฉ ุฎุงุตูุฉ
                            </button>
                        </div>
                        <div id="variantsContainer">
                            <!-- ุตููู ุงููุชุบูุฑุงุช ุชุถุงู ููุง -->
                        </div>
                        <div id="variantsEmptyMsg" style="text-align: center; padding: 15px; color: #999; font-size: 14px;">
                            ูุง ุชูุฌุฏ ุฎุตุงุฆุต - ุงูููุชุฌ ุจููุน ูุงุญุฏ ููุท
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ุงููุฆุฉ:</label>
                        <select id="inventoryCategory">
                            <option value="">-- ุงุฎุชุฑ ูุฆุฉ --</option>
                        </select>
                        <input type="text" id="inventoryNewCategory" placeholder="ุฃู ุฃุถู ูุฆุฉ ุฌุฏูุฏุฉ" style="margin-top: 5px;">
                    </div>
                    <div class="form-group">
                        <label>ุตูุฑุฉ ุงูููุชุฌ:</label>
                        <input type="file" id="inventoryImageInput" accept="image/*" style="display: none;" onchange="handleInventoryImage(this)">
                        <button type="button" onclick="document.getElementById('inventoryImageInput').click()" class="btn" style="background: #38a169;">๐ท ุฑูุน ุตูุฑุฉ</button>
                        <input type="hidden" id="inventoryImageData">
                        <div id="inventoryImagePreview" style="margin-top: 10px; display: none; text-align: center; padding: 15px; border: 2px solid #cbd5e0; border-radius: 8px; background: #f8f9fa;">
                            <div id="inventoryImageDisplay" style="margin: 10px 0;"></div>
                            <button type="button" onclick="removeInventoryImage()" class="btn-danger">๐๏ธ ุญุฐู ุงูุตูุฑุฉ</button>
                        </div>
                    </div>
                    <button type="submit" class="btn">ุญูุธ</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Distribution Modal -->
    <div class="modal" id="distributionModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 id="distributionModalTitle">๐ค ุชูุฒูุน ุงูููุชุฌ ุนูู ุงููุฑูุน</h2>
                <button class="close-btn" onclick="closeDistribution()">โ๏ธ</button>
            </div>
            <div class="modal-body">
                <div id="distributionProductInfo" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;"></div>
                
                <h3>ุงูุชูุฒูุนุงุช ุงูุญุงููุฉ:</h3>
                <div id="currentDistributions" style="margin-bottom: 20px;"></div>
                
                <h3>ุฅุถุงูุฉ ุชูุฒูุน ุฌุฏูุฏ:</h3>
                <form id="distributionForm" style="display: grid; grid-template-columns: 1fr 1fr 1fr auto; gap: 10px; align-items: end;">
                    <div>
                        <label>ุงููุฑุน:</label>
                        <select id="distributionBranch" required style="width: 100%; padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px;">
                        </select>
                    </div>
                    <div id="distributionVariantGroup" style="display: none;">
                        <label>ุงูุฎุงุตูุฉ:</label>
                        <select id="distributionVariant" style="width: 100%; padding: 10px; border: 2px solid #38a169; border-radius: 6px; background: #f0fff4;">
                            <option value="">ุงูููุชุฌ ุงูุฃุณุงุณู</option>
                        </select>
                    </div>
                    <div>
                        <label>ุงููููุฉ:</label>
                        <input type="number" id="distributionStock" required min="1" style="width: 100%; padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px;">
                    </div>
                    <button type="submit" class="btn" style="background: #38a169;">โ ุฅุถุงูุฉ</button>
                    <div style="grid-column: 1 / -1;">
                        <label>ููุงุญุธุงุช:</label>
                        <input type="text" id="distributionNotes" placeholder="ููุงุญุธุงุช (ุงุฎุชูุงุฑู)" style="width: 100%; padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px;">
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Damage Report Modal -->
    <div class="modal" id="damageModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>๐ ุชุณุฌูู ุชุงูู</h2>
                <button class="close-btn" onclick="closeDamageModal()">โ๏ธ</button>
            </div>
            <div class="modal-body">
                <div id="damageProductInfo" style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px;"></div>
                <form id="damageForm">
                    <input type="hidden" id="damageInventoryId">
                    <div class="form-group">
                        <label>ุงููุฑุน:</label>
                        <select id="damageBranch" required onchange="updateDamageStock()" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ุงููุฎุฒูู ุงููุชุงุญ:</label>
                        <div id="availableStock" style="font-size: 18px; font-weight: bold; color: #38a169; padding: 10px; background: #f0fff4; border-radius: 5px;">-</div>
                    </div>
                    <div class="form-group">
                        <label>ุงููููุฉ ุงูุชุงููุฉ:</label>
                        <input type="number" id="damageQuantity" required min="1" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%;">
                    </div>
                    <div class="form-group">
                        <label>ุงูุณุจุจ:</label>
                        <textarea id="damageReason" rows="3" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; width: 100%; resize: vertical;" placeholder="ูุซุงู: ุงููุณุฑุ ููุชูู ุงูุตูุงุญูุฉุ ุชูู ุฃุซูุงุก ุงูููู..."></textarea>
                    </div>
                    <button type="submit" class="btn" style="background: #e53e3e;">๐ ุชุณุฌูู ุงูุชุงูู</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Product Modal -->
    <div class="modal" id="addProductModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="productModalTitle">โ ุฅุถุงูุฉ ููุชุฌ</h2>
                <button class="close-btn" onclick="closeAddProduct()">โ๏ธ</button>
            </div>
            <div class="modal-body">
                <form id="productForm">
                    <input type="hidden" id="productId">
                    <div class="form-group"><label>ุงุณู ุงูููุชุฌ:</label><input type="text" id="productName" required></div>
                    <div class="form-group"><label>ุงูุจุงุฑููุฏ:</label><input type="text" id="productBarcode"></div>
                    <div class="form-group"><label>ุงูุณุนุฑ (ุฏ.ู):</label><input type="number" id="productPrice" step="0.001" required></div>
                    <div class="form-group"><label>ุงููุฎุฒูู:</label><input type="number" id="productStock" value="0"></div>
                    <div class="form-group">
                        <label>ุงููุฆุฉ:</label>
                        <select id="productCategory">
                            <option value="">-- ุงุฎุชุฑ ูุฆุฉ --</option>
                        </select>
                        <input type="text" id="newCategory" placeholder="ุฃู ุฃุถู ูุฆุฉ ุฌุฏูุฏุฉ" style="margin-top: 5px;">
                    </div>
                    <div class="form-group" id="productBranchField">
                        <label>ุงููุฑุน:</label>
                        <select id="productBranch">
                            <option value="1">ุงููุฑุน ุงูุฑุฆูุณู</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ุตูุฑุฉ ุงูููุชุฌ:</label>
                        <input type="file" id="productImageInput" accept="image/*" style="display: none;" onchange="handleProductImage(this)">
                        <button type="button" onclick="document.getElementById('productImageInput').click()" class="btn" style="background: #38a169;">๐ท ุฑูุน ุตูุฑุฉ</button>
                        <input type="hidden" id="productImageData">
                        <div id="productImagePreview" style="margin-top: 10px; display: none; text-align: center; padding: 15px; border: 2px solid #cbd5e0; border-radius: 8px; background: #f8f9fa;">
                            <div id="productImageDisplay" style="margin: 10px 0;"></div>
                            <button type="button" onclick="removeProductImage()" class="btn-danger">๐๏ธ ุญุฐู ุงูุตูุฑุฉ</button>
                        </div>
                    </div>
                    <button type="submit" class="btn">ุญูุธ</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Add User Modal -->
    <div class="modal" id="addUserModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="userModalTitle">โ ุฅุถุงูุฉ ูุณุชุฎุฏู</h2>
                <button class="close-btn" onclick="closeAddUser()">โ๏ธ</button>
            </div>
            <div class="modal-body">
                <form id="userForm">
                    <input type="hidden" id="userId">
                    <div class="form-group"><label>ุงุณู ุงููุณุชุฎุฏู:</label><input type="text" id="username" required></div>
                    <div class="form-group"><label>ูููุฉ ุงููุฑูุฑ:</label><input type="password" id="userPassword" required></div>
                    <div class="form-group"><label>ุงูุงุณู ุงููุงูู:</label><input type="text" id="fullName" required></div>
                    <div class="form-group">
                        <label>ุงูุตูุงุญูุฉ:</label>
                        <select id="userRole">
                            <option value="cashier">ูุงุดูุฑ</option>
                            <option value="admin">ูุฏูุฑ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ุงููุฑุน:</label>
                        <select id="userBranch">
                            <option value="1">ุงููุฑุน ุงูุฑุฆูุณู</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ุงูุดูุช:</label>
                        <select id="userShift">
                            <option value="">-- ุจุฏูู ุดูุช --</option>
                        </select>
                    </div>
                    <div class="form-group"><label>ุจุงุฏุฆุฉ ุงููุงุชูุฑุฉ:</label><input type="text" id="invoicePrefix" maxlength="10" placeholder="AHM, S1"></div>
                    
                    <div class="form-group" id="permissionsSection" style="display: none;">
                        <label style="font-weight: bold; font-size: 16px; margin-bottom: 10px; display: block; color: #667eea;">๐ ุงูุตูุงุญูุงุช ุงูุชูุตูููุฉ</label>
                        <div style="border: 2px solid #e2e8f0; padding: 15px; border-radius: 8px; background: #f8f9fa;">
                            
                            <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #cbd5e0;">
                                <strong style="color: #667eea; font-size: 14px;">๐ฆ ุงูููุชุฌุงุช</strong>
                                <div style="margin: 10px 0 5px 20px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_products" style="width: 18px; height: 18px;" checked>
                                        <span>๐๏ธ ุนุฑุถ ุงูููุชุฌุงุช</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_add_products" style="width: 18px; height: 18px;">
                                        <span>โ ุฅุถุงูุฉ ููุชุฌุงุช</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_edit_products" style="width: 18px; height: 18px;">
                                        <span>โ๏ธ ุชุนุฏูู ููุชุฌุงุช</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_delete_products" style="width: 18px; height: 18px;">
                                        <span>๐๏ธ ุญุฐู ููุชุฌุงุช</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #cbd5e0;">
                                <strong style="color: #667eea; font-size: 14px;">๐ ุงููุฎุฒูู</strong>
                                <div style="margin: 10px 0 5px 20px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_inventory" style="width: 18px; height: 18px;">
                                        <span>๐๏ธ ุนุฑุถ ุงููุฎุฒูู</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_add_inventory" style="width: 18px; height: 18px;">
                                        <span>โ ุฅุถุงูุฉ ูููุฎุฒูู</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_edit_inventory" style="width: 18px; height: 18px;">
                                        <span>โ๏ธ ุชุนุฏูู ุงููุฎุฒูู</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_delete_inventory" style="width: 18px; height: 18px;">
                                        <span>๐๏ธ ุญุฐู ูู ุงููุฎุฒูู</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #cbd5e0;">
                                <strong style="color: #667eea; font-size: 14px;">๐งพ ุงูููุงุชูุฑ</strong>
                                <div style="margin: 10px 0 5px 20px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_invoices" style="width: 18px; height: 18px;" checked>
                                        <span>๐๏ธ ุนุฑุถ ูู ุงูููุงุชูุฑ</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_delete_invoices" style="width: 18px; height: 18px;">
                                        <span>๐๏ธ ุญุฐู ุงูููุงุชูุฑ</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_cancel_invoices" style="width: 18px; height: 18px;">
                                        <span>โ ุฅูุบุงุก ุงูููุงุชูุฑ</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_edit_completed_invoices" style="width: 18px; height: 18px;">
                                        <span>โ๏ธ ุชุนุฏูู ุงูููุงุชูุฑ ุงูููุฌุฒุฉ</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #cbd5e0;">
                                <strong style="color: #667eea; font-size: 14px;">๐ฅ ุงูุนููุงุก (CRM)</strong>
                                <div style="margin: 10px 0 5px 20px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_customers" style="width: 18px; height: 18px;" checked>
                                        <span>๐๏ธ ุนุฑุถ ุงูุนููุงุก</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_add_customer" style="width: 18px; height: 18px;">
                                        <span>โ ุฅุถุงูุฉ ุนููู</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_edit_customer" style="width: 18px; height: 18px;">
                                        <span>โ๏ธ ุชุนุฏูู ุนููู</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_delete_customer" style="width: 18px; height: 18px;">
                                        <span>๐๏ธ ุญุฐู ุนููู</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #cbd5e0;">
                                <strong style="color: #667eea; font-size: 14px;">๐ ุงูุชูุงุฑูุฑ ูุงููุญุงุณุจุฉ</strong>
                                <div style="margin: 10px 0 5px 20px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_reports" style="width: 18px; height: 18px;">
                                        <span>๐ ุนุฑุถ ุงูุชูุงุฑูุฑ</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_accounting" style="width: 18px; height: 18px;">
                                        <span>๐ฐ ุนุฑุถ ุงููุญุงุณุจุฉ</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_advanced_reports" style="width: 18px; height: 18px;">
                                        <span>๐ ุชูุงุฑูุฑ ูุชูุฏูุฉ</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_system_logs" style="width: 18px; height: 18px;">
                                        <span>๐ ุณุฌู ุงููุธุงู</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_dcf" style="width: 18px; height: 18px;">
                                        <span>๐ ุชูููู DCF</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_xbrl" style="width: 18px; height: 18px;">
                                        <span>๐ ุชูุงุฑูุฑ XBRL</span>
                                    </label>
                                </div>
                            </div>

                            <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #cbd5e0;">
                                <strong style="color: #667eea; font-size: 14px;">๐ ุงููุฑุชุฌุนุงุช</strong>
                                <div style="margin: 10px 0 5px 20px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_returns" style="width: 18px; height: 18px;">
                                        <span>๐๏ธ ุนุฑุถ ุงููุฑุชุฌุนุงุช</span>
                                    </label>
                                </div>
                            </div>

                            <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #cbd5e0;">
                                <strong style="color: #667eea; font-size: 14px;">๐ฐ ุงูุชูุงููู</strong>
                                <div style="margin: 10px 0 5px 20px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_expenses" style="width: 18px; height: 18px;">
                                        <span>๐๏ธ ุนุฑุถ ุงูุชูุงููู</span>
                                    </label>
                                </div>
                            </div>

                            <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #cbd5e0;">
                                <strong style="color: #667eea; font-size: 14px;">๐ญ ุงูููุฑุฏูู</strong>
                                <div style="margin: 10px 0 5px 20px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_suppliers" style="width: 18px; height: 18px;">
                                        <span>๐๏ธ ุนุฑุถ ุงูููุฑุฏูู</span>
                                    </label>
                                </div>
                            </div>

                            <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #cbd5e0;">
                                <strong style="color: #667eea; font-size: 14px;">๐๏ธ ุงูููุจููุงุช</strong>
                                <div style="margin: 10px 0 5px 20px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_coupons" style="width: 18px; height: 18px;">
                                        <span>๐๏ธ ุนุฑุถ ุงูููุจููุงุช</span>
                                    </label>
                                </div>
                            </div>

                            <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #cbd5e0;">
                                <strong style="color: #667eea; font-size: 14px;">๐ข ุงููุฑูุน ูุงููุฎุฒูู</strong>
                                <div style="margin: 10px 0 5px 20px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_cross_branch_stock" style="width: 18px; height: 18px;">
                                        <span>๐ข ุนุฑุถ ุชููุฑ ุงูููุชุฌุงุช ูู ุงููุฑูุน ุงูุฃุฎุฑู</span>
                                    </label>
                                </div>
                            </div>

                            <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #cbd5e0;">
                                <strong style="color: #667eea; font-size: 14px;">๐ ุทูุจุงุช ุงูููู ุงููุฎุฒูู</strong>
                                <div style="margin: 10px 0 5px 20px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_transfers" style="width: 18px; height: 18px;">
                                        <span>๐๏ธ ุนุฑุถ ุทูุจุงุช ุงูููู</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_create_transfer" style="width: 18px; height: 18px;">
                                        <span>โ ุฅูุดุงุก ุทูุจ ููู</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_approve_transfer" style="width: 18px; height: 18px;">
                                        <span>โ ุงูููุงููุฉ/ุฑูุถ ุงูุทูุจุงุช</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_deliver_transfer" style="width: 18px; height: 18px;">
                                        <span>๐ ุงุณุชูุงู ูุชูุตูู (ุณุงุฆู)</span>
                                    </label>
                                </div>
                            </div>

                            <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #cbd5e0;">
                                <strong style="color: #667eea; font-size: 14px;">๐ณ ุงูุงุดุชุฑุงูุงุช</strong>
                                <div style="margin-top: 8px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_subscriptions" style="width: 18px; height: 18px;">
                                        <span>๐๏ธ ุนุฑุถ ุงูุงุดุชุฑุงูุงุช</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_manage_subscriptions" style="width: 18px; height: 18px;">
                                        <span>โ๏ธ ุฅุฏุงุฑุฉ ุงูุงุดุชุฑุงูุงุช ูุงููุฆุงุช</span>
                                    </label>
                                </div>
                            </div>

                            <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #cbd5e0;">
                                <strong style="color: #667eea; font-size: 14px;">๐ฝ๏ธ ุงูุทุงููุงุช</strong>
                                <div style="margin: 10px 0 5px 20px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_tables" style="width: 18px; height: 18px;">
                                        <span>๐๏ธ ุนุฑุถ ุงูุทุงููุงุช</span>
                                    </label>
                                </div>
                            </div>

                            <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #cbd5e0;">
                                <strong style="color: #667eea; font-size: 14px;">โฐ ุงูุญุถูุฑ</strong>
                                <div style="margin: 10px 0 5px 20px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_attendance" style="width: 18px; height: 18px;">
                                        <span>๐๏ธ ุนุฑุถ ุงูุญุถูุฑ</span>
                                    </label>
                                </div>
                            </div>

                            <div style="margin-bottom: 10px;">
                                <strong style="color: #667eea; font-size: 14px;">โ๏ธ ุงูุฅุฏุงุฑุฉ</strong>
                                <div style="margin: 10px 0 5px 20px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_manage_users" style="width: 18px; height: 18px;">
                                        <span>๐ฅ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_access_settings" style="width: 18px; height: 18px;">
                                        <span>โ๏ธ ุงููุตูู ููุฅุนุฏุงุฏุงุช</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 5px 0;">
                                        <input type="checkbox" name="can_view_branches" style="width: 18px; height: 18px;">
                                        <span>๐ข ุฅุฏุงุฑุฉ ุงููุฑูุน</span>
                                    </label>
                                </div>
                            </div>
                            
                            <p style="font-size: 12px; color: #6c757d; margin: 15px 0 0; padding-top: 10px; border-top: 1px solid #cbd5e0;">
                                ๐ก <strong>ููุงุญุธุฉ:</strong> ุงููุฏูุฑ ูุฏูู ุฌููุน ุงูุตูุงุญูุงุช ุชููุงุฆูุงู ููุง ูุญุชุงุฌ ูุชุญุฏูุฏูุง
                            </p>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn">ุญูุธ</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Branch Modal -->
    <div class="modal" id="addBranchModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="branchModalTitle">โ ุฅุถุงูุฉ ูุฑุน</h2>
                <button class="close-btn" onclick="closeAddBranch()">โ๏ธ</button>
            </div>
            <div class="modal-body">
                <form id="branchForm">
                    <input type="hidden" id="branchId">
                    <div class="form-group"><label>ุงุณู ุงููุฑุน:</label><input type="text" id="branchName" required></div>
                    <div class="form-group"><label>ุงููููุน:</label><input type="text" id="branchLocation"></div>
                    <div class="form-group"><label>ุฑูู ุงููุงุชู:</label><input type="tel" id="branchPhone"></div>
                    <button type="submit" class="btn">ุญูุธ</button>
                </form>
            </div>
        </div>
    </div>

        <!-- Suppliers Tab -->
        <div class="tab-content" id="suppliersTab" style="display: none;">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>๐ญ ุงูููุฑุฏูู</h2>
                    <button onclick="showAddSupplier()" class="add-btn">โ ุฅุถุงูุฉ ููุฑุฏ</button>
                </div>
                <div id="suppliersContainer"></div>
            </div>
        </div>

    <!-- Stock Transfers Tab -->
        <div class="tab-content" id="transfersTab" style="display: none;">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 10px;">
                    <h2>๐ ุทูุจุงุช ุงูููู ุงููุฎุฒูู</h2>
                    <button onclick="showCreateTransfer()" class="add-btn" id="createTransferBtn">โ ุทูุจ ููู ุฌุฏูุฏ</button>
                </div>
                <!-- ููุงุชุฑ -->
                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 15px; align-items: center;">
                    <select id="transferStatusFilter" onchange="loadStockTransfers()" style="padding:8px 12px; border-radius:6px; border:1px solid #ddd;">
                        <option value="">ูู ุงูุญุงูุงุช</option>
                        <option value="pending">โณ ููุฏ ุงูุงูุชุธุงุฑ</option>
                        <option value="approved">โ ุชู ุงูุชุฌููุฒ</option>
                        <option value="in_transit">๐ ุฌุงุฑู ุงูุชูุตูู</option>
                        <option value="completed">๐ฆ ููุชูู</option>
                        <option value="rejected">โ ูุฑููุถ</option>
                    </select>
                    <select id="transferBranchFilter" onchange="loadStockTransfers()" style="padding:8px 12px; border-radius:6px; border:1px solid #ddd;">
                        <option value="">ูู ุงููุฑูุน</option>
                    </select>
                </div>
                <div id="transfersStats" style="margin-bottom:10px; font-size:13px; color:#666;"></div>
                <div id="transfersTableContainer"></div>
            </div>
        </div>

    <!-- Create Transfer Modal -->
    <div class="modal" id="createTransferModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>๐ ุทูุจ ููู ูุฎุฒูู ุฌุฏูุฏ</h2>
                <button class="close-btn" onclick="closeCreateTransfer()">โ๏ธ</button>
            </div>
            <div class="modal-body">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                    <div class="form-group">
                        <label>ุงููุฑุน ุงููุตุฏุฑ (ููุตุฑู ููู):</label>
                        <select id="transferFromBranch" required style="width:100%; padding:10px; border:2px solid #e2e8f0; border-radius:8px;">
                            <option value="">ุงุฎุชุฑ ุงููุฑุน</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ุงููุฑุน ุงูุทุงูุจ (ูุณุชูู):</label>
                        <select id="transferToBranch" required style="width:100%; padding:10px; border:2px solid #e2e8f0; border-radius:8px;">
                            <option value="">ุงุฎุชุฑ ุงููุฑุน</option>
                        </select>
                    </div>
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <label>ููุงุญุธุงุช:</label>
                    <input type="text" id="transferNotes" placeholder="ุณุจุจ ุงูุทูุจ ุฃู ููุงุญุธุงุช..." style="width:100%; padding:10px; border:2px solid #e2e8f0; border-radius:8px;">
                </div>
                <!-- ุงุฎุชูุงุฑ ูุฅุถุงูุฉ ุงูููุชุฌุงุช -->
                <div style="margin-bottom: 15px;">
                    <label style="font-weight:bold; display:block; margin-bottom:8px;">ุฅุถุงูุฉ ุฃุตูุงู:</label>
                    <div style="display: flex; gap: 10px; align-items: end;">
                        <div style="flex:1;">
                            <select id="transferProductSelect" style="width:100%; padding:10px; border:2px solid #e2e8f0; border-radius:8px; font-size:14px;">
                                <option value="">-- ุงุฎุชุฑ ุงูุตูู --</option>
                            </select>
                        </div>
                        <div style="width:90px;">
                            <label style="font-size:11px; color:#666;">ุงููููุฉ</label>
                            <input type="number" id="transferProductQty" value="1" min="1" style="width:100%; padding:10px; border:2px solid #e2e8f0; border-radius:8px; text-align:center;">
                        </div>
                        <button type="button" onclick="addTransferItemFromSelect()" style="padding:10px 18px; background:#667eea; color:#fff; border:none; border-radius:8px; cursor:pointer; font-size:14px; white-space:nowrap;">โ ุฃุถู</button>
                    </div>
                </div>
                <!-- ุนูุงุตุฑ ุงูุทูุจ -->
                <div id="transferItemsContainer" style="margin-bottom: 15px;">
                    <table style="width:100%; border-collapse:collapse; font-size:13px;">
                        <thead>
                            <tr style="background:#f7fafc;">
                                <th style="padding:8px; text-align:right; border-bottom:2px solid #e2e8f0;">ุงูุตูู</th>
                                <th style="padding:8px; text-align:center; border-bottom:2px solid #e2e8f0; width:120px;">ุงููููุฉ</th>
                                <th style="padding:8px; text-align:center; border-bottom:2px solid #e2e8f0; width:60px;">ุญุฐู</th>
                            </tr>
                        </thead>
                        <tbody id="transferItemsBody"></tbody>
                    </table>
                </div>
                <button onclick="submitTransferRequest()" class="btn" style="width:100%; padding:12px; background:#667eea; font-size:16px; border:none; color:#fff; border-radius:8px; cursor:pointer;">๐ค ุฅุฑุณุงู ุงูุทูุจ</button>
            </div>
        </div>
    </div>

    <!-- Transfer Details Modal -->
    <div class="modal" id="transferDetailsModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>๐ ุชูุงุตูู ุทูุจ ุงูููู</h2>
                <button class="close-btn" onclick="closeTransferDetails()">โ๏ธ</button>
            </div>
            <div class="modal-body" id="transferDetailsContent"></div>
        </div>
    </div>

    <!-- Subscriptions Tab -->
        <div class="tab-content" id="subscriptionsTab" style="display: none;">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                    <h2>๐ณ ูุธุงู ุงูุงุดุชุฑุงูุงุช</h2>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                        <button class="add-btn" onclick="showManagePlans()" id="managePlansBtn">๐ ุฅุฏุงุฑุฉ ุงููุฆุงุช</button>
                        <button class="add-btn" onclick="showAddSubscription()">โ ุงุดุชุฑุงู ุฌุฏูุฏ</button>
                    </div>
                </div>
                <!-- ุฏุงุดุจูุฑุฏ ุงููุฆุงุช -->
                <div id="subCategoryDashboard" style="margin-bottom: 20px;"></div>

                <div style="display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap;">
                    <select id="subStatusFilter" onchange="loadSubscriptions()" style="padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px;">
                        <option value="">ูู ุงูุญุงูุงุช</option>
                        <option value="active">ูุนูุงู</option>
                        <option value="expired">ููุชูู</option>
                        <option value="cancelled">ููุบู</option>
                    </select>
                    <input type="text" id="subSearchInput" placeholder="ุจุญุซ ุจุงูุงุณู ุฃู ุงููุงุชู ุฃู ุงูููุฏ..." oninput="filterSubscriptions()" style="flex: 1; min-width: 200px; padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px;">
                </div>
                <div id="subscriptionsTableContainer"></div>
            </div>
        </div>

    <!-- Subscription Plans Modal -->
    <div class="modal" id="managePlansModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>๐ ุฅุฏุงุฑุฉ ูุฆุงุช ุงูุงุดุชุฑุงู</h2>
                <button class="close-btn" onclick="closePlansModal()">โ๏ธ</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                    <h3 style="margin-bottom: 10px;">โ ุฅุถุงูุฉ ูุฆุฉ ุฌุฏูุฏุฉ</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">
                        <input type="text" id="planName" placeholder="ุงุณู ุงููุฆุฉ *" style="padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px;">
                        <input type="number" id="planDuration" placeholder="ุงููุฏุฉ (ุฃูุงู)" value="30" min="1" style="padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px;">
                        <input type="number" id="planPrice" placeholder="ุงูุณุนุฑ *" step="0.001" min="0" style="padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px;">
                        <input type="text" id="planDesc" placeholder="ุงููุตู (ุงุฎุชูุงุฑู)" style="padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px;">
                    </div>
                    <!-- ุตูุฑุฉ ุงููุฆุฉ -->
                    <div style="margin-top: 12px; padding: 12px; background: #fff; border: 2px solid #e0e0e0; border-radius: 8px;">
                        <h4 style="margin: 0 0 8px 0;">๐ผ๏ธ ุตูุฑุฉ ุงููุฆุฉ</h4>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: start;">
                            <div>
                                <button type="button" onclick="document.getElementById('planImageUpload').click()" class="btn" style="padding:6px 14px; background:#667eea; color:white; border:none; border-radius:6px; cursor:pointer;">๐ค ุฑูุน ุตูุฑุฉ</button>
                                <input type="file" id="planImageUpload" accept="image/*" onchange="handlePlanImageUpload(event)" style="display:none;">
                                <button type="button" onclick="showPlanTemplates()" class="btn" style="padding:6px 14px; background:#764ba2; color:white; border:none; border-radius:6px; cursor:pointer; margin-right:5px;">๐จ ุชุตููู ุฌุงูุฒ</button>
                            </div>
                            <div id="planImagePreview" style="width:160px; height:100px; border:2px dashed #ccc; border-radius:8px; display:flex; align-items:center; justify-content:center; overflow:hidden; background:#fafafa;">
                                <span style="color:#aaa; font-size:12px;">ูุนุงููุฉ ุงูุตูุฑุฉ</span>
                            </div>
                        </div>
                        <div id="planTemplatesGrid" style="display:none; margin-top:10px;"></div>
                        <input type="hidden" id="planImageData" value="">
                    </div>
                    <!-- ููุชุฌุงุช ุงููุฆุฉ -->
                    <div style="margin-top: 12px; padding: 12px; background: #fff; border: 2px solid #e0e0e0; border-radius: 8px;">
                        <h4 style="margin: 0 0 8px 0;">๐ฆ ููุชุฌุงุช ุงููุฆุฉ</h4>
                        <div style="display: flex; gap: 8px; flex-wrap: wrap; align-items: end;">
                            <select id="planProductSelect" style="flex: 2; min-width: 200px; padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px;">
                                <option value="">-- ุงุฎุชุฑ ููุชุฌ --</option>
                            </select>
                            <input type="number" id="planProductQty" placeholder="ุงููููุฉ" value="1" min="1" style="width: 80px; padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px;">
                            <button type="button" onclick="addProductToPlan()" class="add-btn" style="white-space: nowrap;">โ ุฃุถู</button>
                        </div>
                        <div id="planItemsList" style="margin-top: 10px;"></div>
                    </div>
                    <button onclick="savePlan()" class="add-btn" style="margin-top: 10px;">๐พ ุญูุธ ุงููุฆุฉ</button>
                </div>
                <div id="plansListContainer"></div>
            </div>
        </div>
    </div>

    <!-- Add Subscription Modal -->
    <div class="modal" id="addSubscriptionModal">
        <div class="modal-content" style="max-width: 550px;">
            <div class="modal-header">
                <h2>โ ุงุดุชุฑุงู ุฌุฏูุฏ</h2>
                <button class="close-btn" onclick="closeAddSubscription()">โ๏ธ</button>
            </div>
            <div class="modal-body">
                <div style="display: grid; gap: 12px;">
                    <div>
                        <label style="font-weight: bold; display: block; margin-bottom: 5px;">ุงูุนููู *</label>
                        <select id="subCustomerId" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px;" required>
                            <option value="">-- ุงุฎุชุฑ ุงูุนููู --</option>
                        </select>
                    </div>
                    <div>
                        <label style="font-weight: bold; display: block; margin-bottom: 5px;">ูุฆุฉ ุงูุงุดุชุฑุงู *</label>
                        <select id="subPlanId" onchange="onPlanSelect()" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px;" required>
                            <option value="">-- ุงุฎุชุฑ ุงููุฆุฉ --</option>
                        </select>
                    </div>
                    <div id="subPlanInfo" style="display: none; background: #f0f9ff; padding: 12px; border-radius: 8px; border: 2px solid #bae6fd;">
                        <div id="subPlanDetails"></div>
                    </div>
                    <div>
                        <label style="font-weight: bold; display: block; margin-bottom: 5px;">ููุฏ ุงูุงุดุชุฑุงู *</label>
                        <div style="display: flex; gap: 8px;">
                            <input type="text" id="subCode" placeholder="ููุฏ ูุฑูุฏ ูููุดุชุฑู" style="flex: 1; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px; text-transform: uppercase;">
                            <button onclick="generateSubCode()" type="button" style="padding: 10px 15px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; white-space: nowrap;">๐ฒ ุชูููุฏ</button>
                        </div>
                    </div>
                    <div>
                        <label style="font-weight: bold; display: block; margin-bottom: 5px;">ุชุงุฑูุฎ ุงูุจุฏุก</label>
                        <input type="date" id="subStartDate" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px;">
                    </div>
                    <div>
                        <label style="font-weight: bold; display: block; margin-bottom: 5px;">ุงููุจูุบ ุงููุฏููุน</label>
                        <input type="number" id="subPricePaid" step="0.001" min="0" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px;">
                    </div>
                    <div>
                        <label style="font-weight: bold; display: block; margin-bottom: 5px;">ููุงุญุธุงุช</label>
                        <textarea id="subNotes" rows="2" placeholder="ููุงุญุธุงุช (ุงุฎุชูุงุฑู)" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px; font-family: inherit;"></textarea>
                    </div>
                    <button onclick="submitSubscription()" class="complete-btn" style="padding: 12px;">๐ณ ุชุณุฌูู ุงูุงุดุชุฑุงู</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Subscription Redemption Modal -->
    <div class="modal" id="redeemSubscriptionModal">
        <div class="modal-content" style="max-width: 650px;">
            <div class="modal-header">
                <h2>๐ฆ ุงุณุชูุงู ููุชุฌุงุช ุงูุงุดุชุฑุงู</h2>
                <button class="close-btn" onclick="closeRedeemModal()">โ๏ธ</button>
            </div>
            <div class="modal-body">
                <div id="redeemSubInfo" style="background: linear-gradient(135deg, #667eea15, #764ba215); padding: 12px; border-radius: 8px; border: 2px solid #764ba2; margin-bottom: 15px;"></div>
                <div id="redeemItemsList"></div>
                <button onclick="submitRedemption()" class="complete-btn" style="margin-top: 15px; padding: 12px; width: 100%;">โ ุชุฃููุฏ ุงูุงุณุชูุงู</button>
            </div>
        </div>
    </div>

    <!-- Subscription Detail Modal -->
    <div class="modal" id="subscriptionDetailModal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2>๐ ุชูุงุตูู ุงูุงุดุชุฑุงู</h2>
                <button class="close-btn" onclick="document.getElementById('subscriptionDetailModal').classList.remove('active')">โ๏ธ</button>
            </div>
            <div class="modal-body" id="subscriptionDetailBody"></div>
        </div>
    </div>

    <!-- Add/Edit Supplier Modal -->
    <div class="modal" id="addSupplierModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="supplierModalTitle">โ ุฅุถุงูุฉ ููุฑุฏ</h2>
                <button onclick="closeAddSupplier()" class="close-btn">&times;</button>
            </div>
            <form id="supplierForm">
                <input type="hidden" id="supplierId">
                <div class="form-group">
                    <label>ุงุณู ุงูููุฑุฏ:</label>
                    <input type="text" id="supplierName" required>
                </div>
                <div class="form-group">
                    <label>ุงูุดุฑูุฉ:</label>
                    <input type="text" id="supplierCompany">
                </div>
                <div class="form-group">
                    <label>ุงููุงุชู:</label>
                    <input type="tel" id="supplierPhone">
                </div>
                <div class="form-group">
                    <label>ุงูุจุฑูุฏ:</label>
                    <input type="email" id="supplierEmail">
                </div>
                <div class="form-group">
                    <label>ุงูุนููุงู:</label>
                    <textarea id="supplierAddress" rows="2"></textarea>
                </div>
                <div class="form-group">
                    <label>ููุงุญุธุงุช:</label>
                    <textarea id="supplierNotes" rows="2"></textarea>
                </div>
                <button type="submit" class="btn" style="width: 100%; padding: 12px;">๐พ ุญูุธ</button>
            </form>
        </div>
    </div>

    <!-- Supplier Invoices Modal -->
    <div class="modal" id="supplierInvoicesModal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2 id="supplierInvoicesTitle">๐ ููุงุชูุฑ ุงูููุฑุฏ</h2>
                <button onclick="closeSupplierInvoices()" class="close-btn">&times;</button>
            </div>
            <div style="margin-bottom: 15px;">
                <button onclick="showAddSupplierInvoice()" class="add-btn">โ ุฅุถุงูุฉ ูุงุชูุฑุฉ</button>
            </div>
            <div id="supplierInvoicesList"></div>
        </div>
    </div>

    <!-- Add Supplier Invoice Modal -->
    <div class="modal" id="addSupplierInvoiceModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>๐ ุฅุถุงูุฉ ูุงุชูุฑุฉ ููุฑุฏ</h2>
                <button onclick="closeAddSupplierInvoice()" class="close-btn">&times;</button>
            </div>
            <form id="supplierInvoiceForm">
                <input type="hidden" id="supplierInvoiceSupplierId">
                <div class="form-group">
                    <label>ุฑูู ุงููุงุชูุฑุฉ:</label>
                    <input type="text" id="supplierInvoiceNumber">
                </div>
                <div class="form-group">
                    <label>ุงููุจูุบ (ุฏ.ู):</label>
                    <input type="number" id="supplierInvoiceAmount" step="0.001" min="0">
                </div>
                <div class="form-group">
                    <label>ุชุงุฑูุฎ ุงููุงุชูุฑุฉ:</label>
                    <input type="date" id="supplierInvoiceDate">
                </div>
                <div class="form-group">
                    <label>ููุงุญุธุงุช:</label>
                    <textarea id="supplierInvoiceNotes" rows="2"></textarea>
                </div>
                <div class="form-group">
                    <label>ุตูุฑุฉ ุงููุงุชูุฑุฉ / PDF (ุญุฏ ุฃูุตู 1 MB):</label>
                    <input type="file" id="supplierInvoiceFile" accept="image/*,.pdf" onchange="validateSupplierFile(this)">
                    <small id="supplierFileInfo" style="color: #6c757d;"></small>
                </div>
                <button type="submit" class="btn" style="width: 100%; padding: 12px;">๐พ ุญูุธ ุงููุงุชูุฑุฉ</button>
            </form>
        </div>
    </div>

    <!-- View Supplier Invoice File Modal -->
    <div class="modal" id="viewSupplierFileModal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2>๐ ุนุฑุถ ุงููุงุชูุฑุฉ</h2>
                <button onclick="document.getElementById('viewSupplierFileModal').classList.remove('active')" class="close-btn">&times;</button>
            </div>
            <div id="supplierFileViewer" style="text-align: center; padding: 20px;"></div>
        </div>
    </div>

    <!-- Invoice View Modal -->
    <!-- Cancel Invoice Modal -->
    <div class="modal" id="cancelInvoiceModal">
        <div class="modal-content" style="max-width: 450px;">
            <div class="modal-header" style="background: #dc3545;">
                <h2>๐ซ ุฅูุบุงุก ุงููุงุชูุฑุฉ</h2>
                <button class="close-btn" onclick="closeCancelInvoiceModal()">โ๏ธ</button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <input type="hidden" id="cancelInvoiceId">
                <div style="margin-bottom: 15px;">
                    <label style="font-weight: bold; display: block; margin-bottom: 8px;">ุณุจุจ ุงูุฅูุบุงุก:</label>
                    <select id="cancelReasonSelect" onchange="toggleCustomReason()" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px;">
                        <option value="">-- ุงุฎุชุฑ ุงูุณุจุจ --</option>
                        <option value="ูุงุชูุฑุฉ ููุฑุฑุฉ">ูุงุชูุฑุฉ ููุฑุฑุฉ</option>
                        <option value="ูุงุชูุฑุฉ ููุบูุฉ">ูุงุชูุฑุฉ ููุบูุฉ</option>
                        <option value="ุฎุทุฃ ูู ุงูุจูุงูุงุช">ุฎุทุฃ ูู ุงูุจูุงูุงุช</option>
                        <option value="ุฎุทุฃ ูู ุงูููุชุฌุงุช">ุฎุทุฃ ูู ุงูููุชุฌุงุช</option>
                        <option value="ุฎุทุฃ ูู ุงูุณุนุฑ">ุฎุทุฃ ูู ุงูุณุนุฑ</option>
                        <option value="ุทูุจ ุงูุนููู">ุทูุจ ุงูุนููู</option>
                        <option value="custom">ุณุจุจ ุขุฎุฑ...</option>
                    </select>
                </div>
                <div id="customReasonDiv" style="margin-bottom: 15px; display: none;">
                    <input type="text" id="customReasonInput" placeholder="ุงูุชุจ ุงูุณุจุจ..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px;">
                </div>
                <div style="margin-bottom: 20px; background: #fff3cd; padding: 12px; border-radius: 8px; border: 1px solid #ffc107;">
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 14px;">
                        <input type="checkbox" id="returnStockCheckbox" checked style="width: 18px; height: 18px;">
                        <span>ุฅุฑุฌุงุน ุงูููุชุฌุงุช ุฅูู ุงููุฎุฒูู (ููุณ ุงููุฑุน)</span>
                    </label>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button onclick="confirmCancelInvoice()" style="flex: 1; padding: 12px; background: #dc3545; color: white; border: none; border-radius: 8px; font-size: 15px; cursor: pointer; font-weight: bold;">๐ซ ุชุฃููุฏ ุงูุฅูุบุงุก</button>
                    <button onclick="closeCancelInvoiceModal()" style="flex: 1; padding: 12px; background: #6c757d; color: white; border: none; border-radius: 8px; font-size: 15px; cursor: pointer;">ุฅูุบุงุก</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="invoiceViewModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>๐งพ ุงููุงุชูุฑุฉ</h2>
                <div style="display: flex; gap: 10px;">
                    <button onclick="printInvoiceFromView()" class="btn">๐จ๏ธ ุทุจุงุนุฉ</button>
                    <button onclick="printThermalInvoice()" class="btn" style="background: #e67e22; font-size: 12px;">๐งพ 57ร40</button>
                    <button onclick="openEditInvoiceModal()" class="btn" id="editInvoiceBtn" style="background: #38a169; font-size: 12px;">โ๏ธ ุชุนุฏูู</button>
                    <button onclick="showCancelInvoiceModal()" class="btn" id="cancelInvoiceBtn" style="background: #dc3545; font-size: 12px;">๐ซ ุฅูุบุงุก</button>
                    <button class="close-btn" onclick="closeInvoiceView()">โ๏ธ</button>
                </div>
            </div>
            <div class="modal-body" id="invoiceViewContent"></div>
        </div>
    </div>

    <!-- Edit Invoice Modal -->
    <div class="modal" id="editInvoiceModal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2>โ๏ธ ุชุนุฏูู ุงููุงุชูุฑุฉ</h2>
                <button class="close-btn" onclick="closeEditInvoiceModal()">โ๏ธ</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editInvoiceId">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                    <div class="form-group">
                        <label>ุงุณู ุงูุนููู:</label>
                        <input type="text" id="editInvCustomerName">
                    </div>
                    <div class="form-group">
                        <label>ูุงุชู ุงูุนููู:</label>
                        <input type="text" id="editInvCustomerPhone">
                    </div>
                    <div class="form-group">
                        <label>ุนููุงู ุงูุนููู:</label>
                        <input type="text" id="editInvCustomerAddress">
                    </div>
                    <div class="form-group">
                        <label>ุทุฑููุฉ ุงูุฏูุน:</label>
                        <select id="editInvPaymentMethod">
                            <option value="cash">ููุฏุงู</option>
                            <option value="knet">ูู ูุช</option>
                            <option value="visa">ููุฒุง</option>
                            <option value="other">ุฃุฎุฑู</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ุฑุณูู ุงูุชูุตูู:</label>
                        <input type="number" id="editInvDeliveryFee" step="0.001" value="0">
                    </div>
                    <div class="form-group">
                        <label>ุงูุฎุตู:</label>
                        <input type="number" id="editInvDiscount" step="0.001" value="0">
                    </div>
                </div>
                <div class="form-group">
                    <label>ููุงุญุธุงุช:</label>
                    <textarea id="editInvNotes" rows="2" style="width: 100%;"></textarea>
                </div>

                <h3 style="margin: 20px 0 10px; color: #667eea;">ุนูุงุตุฑ ุงููุงุชูุฑุฉ</h3>
                <div id="editInvoiceItemsContainer" style="max-height: 300px; overflow-y: auto;"></div>

                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px; padding-top: 15px; border-top: 2px solid #667eea;">
                    <div>
                        <span style="font-size: 18px; font-weight: bold; color: #667eea;">ุงูุฅุฌูุงูู: <span id="editInvTotal">0.000</span> ุฏ.ู</span>
                    </div>
                    <button onclick="saveEditedInvoice()" class="btn" style="background: #38a169; padding: 12px 30px;">ุญูุธ ุงูุชุนุฏููุงุช</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Shifts Management Modal -->
    <div class="modal" id="shiftsManagementModal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2>๐ ุฅุฏุงุฑุฉ ุงูุดูุชุงุช</h2>
                <button class="close-btn" onclick="closeShiftsManagement()">โ๏ธ</button>
            </div>
            <div class="modal-body">
                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; align-items: center;">
                    <input type="text" id="newShiftName" placeholder="ุงุณู ุงูุดูุช (ูุซู: ุดูุช ุฃ)" style="flex: 1; min-width:120px; padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px;">
                    <input type="time" id="newShiftStart" style="padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px;">
                    <input type="time" id="newShiftEnd" style="padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px;">
                    <label style="display:flex; align-items:center; gap:5px; font-size:13px; cursor:pointer; white-space:nowrap;">
                        <input type="checkbox" id="newShiftAutoLock"> ๐ ููู ุชููุงุฆู
                    </label>
                    <button onclick="addNewShift()" class="btn" style="background: #667eea; white-space: nowrap;">โ ุฅุถุงูุฉ</button>
                </div>
                <div id="shiftsListContainer" style="min-height: 100px;">
                    <div style="text-align: center; color: #a0aec0; padding: 30px;">ุฌุงุฑู ุงูุชุญููู...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Expense Modal -->
    <div class="modal" id="addExpenseModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="expenseModalTitle">โ ุฅุถุงูุฉ ุชูููุฉ</h2>
                <button class="close-btn" onclick="closeAddExpense()">โ๏ธ</button>
            </div>
            <div class="modal-body">
                <form id="expenseForm">
                    <div class="form-group">
                        <label>ููุน ุงูุชูููุฉ:</label>
                        <select id="expenseType" required onchange="toggleSalaryDetails()">
                            <option value="">ุงุฎุชุฑ ุงูููุน</option>
                            <option value="ุฅูุฌุงุฑ">๐ข ุฅูุฌุงุฑ ุงููุญู</option>
                            <option value="ุฑูุงุชุจ">๐ฐ ุฑูุงุชุจ ุงูููุธููู</option>
                            <option value="ููุฑุจุงุก ููุงุก">โก ููุฑุจุงุก ููุงุก</option>
                            <option value="ุฅูุชุฑูุช ูุงุชุตุงูุงุช">๐ฑ ุฅูุชุฑูุช ูุงุชุตุงูุงุช</option>
                            <option value="ูุตุงุฑูู ุชูุตูู">๐ ูุตุงุฑูู ุชูุตูู</option>
                            <option value="ุตูุงูุฉ">๐๏ธ ุตูุงูุฉ</option>
                            <option value="ูุตุงุฑูู ุฅุฏุงุฑูุฉ">๐ ูุตุงุฑูู ุฅุฏุงุฑูุฉ</option>
                            <option value="ุชุนุจุฆุฉ ูุชุบููู">๐ฆ ุชุนุจุฆุฉ ูุชุบููู</option>
                            <option value="ุชุณููู ูุฅุนูุงูุงุช">๐ข ุชุณููู ูุฅุนูุงูุงุช</option>
                            <option value="ุฃุฎุฑู">๐ง ุฃุฎุฑู</option>
                        </select>
                    </div>

                    <!-- ูุณู ุชูุงุตูู ุงูุฑูุงุชุจ -->
                    <div id="salaryDetailsSection" style="display: none; background: #f8f9ff; border: 2px solid #667eea; border-radius: 12px; padding: 15px; margin: 10px 0;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <h4 style="color: #667eea; margin: 0;">๐ฅ ุชูุงุตูู ุฑูุงุชุจ ุงูููุธููู</h4>
                            <button type="button" onclick="addSalaryRow()" class="btn" style="background: #38a169; padding: 6px 14px; font-size: 13px;">โ ุฅุถุงูุฉ ููุธู</button>
                        </div>
                        <div id="salaryRowsContainer">
                            <!-- ุตููู ุงูููุธููู ุชุถุงู ููุง -->
                        </div>
                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px; border-radius: 8px; margin-top: 10px; text-align: center;">
                            <span>ุฅุฌูุงูู ุงูุฑูุงุชุจ: </span>
                            <span id="salaryTotalDisplay" style="font-size: 22px; font-weight: bold;">0.000 ุฏ.ู</span>
                        </div>
                    </div>

                    <div class="form-group" id="expenseAmountGroup">
                        <label>ุงููุจูุบ (ุฏ.ู):</label>
                        <input type="number" id="expenseAmount" step="0.001" required>
                    </div>
                    <div class="form-group">
                        <label>ุงูุชุงุฑูุฎ:</label>
                        <input type="date" id="expenseDate" required>
                    </div>
                    <div class="form-group">
                        <label>ุงููุฑุน:</label>
                        <select id="expenseBranch">
                            <option value="">ุงุฎุชุฑ ุงููุฑุน</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ุงููุตู:</label>
                        <textarea id="expenseDescription" rows="3"></textarea>
                    </div>
                    <button type="submit" class="btn">ุญูุธ</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Customer Modal -->
    <div class="modal" id="addCustomerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="customerModalTitle">โ ุฅุถุงูุฉ ุนููู</h2>
                <button class="close-btn" onclick="closeAddCustomer()">โ๏ธ</button>
            </div>
            <div class="modal-body">
                <form id="customerForm">
                    <input type="hidden" id="customerId">
                    
                    <div class="form-group">
                        <label>ุงูุงุณู:</label>
                        <input type="text" id="customerNameField" required>
                    </div>
                    
                    <div class="form-group">
                        <label>ุฑูู ุงููุงุชู:</label>
                        <input type="tel" id="customerPhoneField" required>
                    </div>
                    
                    <div class="form-group">
                        <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:</label>
                        <input type="email" id="customerEmailField">
                    </div>
                    
                    <div class="form-group">
                        <label>ุงูุนููุงู:</label>
                        <textarea id="customerAddressField" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>ููุงุญุธุงุช:</label>
                        <textarea id="customerNotes" rows="3"></textarea>
                    </div>
                    
                    <!-- ููุงุท ุงูููุงุก (ุนูุฏ ุงูุชุนุฏูู ููุท) -->
                    <div id="loyaltyPointsSection" style="display: none;">
                        <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; margin: 15px 0; border: 2px solid #0ea5e9;">
                            <h4 style="color: #0369a1; margin: 0 0 10px 0;">๐ ููุงุท ุงูููุงุก</h4>
                            <div style="font-size: 24px; font-weight: bold; color: #0c4a6e; margin-bottom: 10px;">
                                <span id="customerCurrentPoints">0</span> ููุทุฉ
                            </div>
                            <div style="font-size: 12px; color: #64748b;">
                                ๐ต ุฅุฌูุงูู ุงููุดุชุฑูุงุช: <span id="customerTotalSpent">0.000</span> ุฏ.ู
                            </div>
                            <div style="margin-top: 10px;">
                                <button type="button" onclick="showAdjustPoints()" class="btn" style="background: #38a169; font-size: 13px; padding: 8px 12px;">
                                    โ๏ธ ุชุนุฏูู ุงูููุงุท
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn">ุญูุธ</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Adjust Points Modal -->
    <div class="modal" id="adjustPointsModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2>โ๏ธ ุชุนุฏูู ููุงุท ุงูููุงุก</h2>
                <button class="close-btn" onclick="closeAdjustPoints()">โ๏ธ</button>
            </div>
            <div class="modal-body">
                <form id="adjustPointsForm">
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <div style="text-align: center;">
                            <div style="font-size: 14px; color: #666; margin-bottom: 5px;">ุงูููุงุท ุงูุญุงููุฉ:</div>
                            <div style="font-size: 32px; font-weight: bold; color: #0ea5e9;" id="adjustCurrentPoints">0</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>ุงูููุงุท (ููุฌุจ ููุฅุถุงูุฉุ ุณุงูุจ ููุฎุตู):</label>
                        <input type="number" id="pointsAdjustment" required step="1">
                    </div>
                    
                    <div class="form-group">
                        <label>ุงูุณุจุจ:</label>
                        <textarea id="adjustReason" rows="3" placeholder="ูุซุงู: ุชุนููุถ ุนู ูุดููุฉ ูู ุงูุทูุจ ุงูุณุงุจู"></textarea>
                    </div>
                    
                    <button type="submit" class="btn">ุญูุธ ุงูุชุนุฏูู</button>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
    // ุฅุธูุงุฑ/ุฅุฎูุงุก ูุณู ุงูุตูุงุญูุงุช ุญุณุจ ุงูุฏูุฑ
    document.addEventListener('DOMContentLoaded', function() {
        const roleSelect = document.getElementById('userRole');
        const permSection = document.getElementById('permissionsSection');
        
        if (roleSelect && permSection) {
            roleSelect.addEventListener('change', function() {
                if (this.value === 'cashier') {
                    permSection.style.display = 'block';
                } else {
                    permSection.style.display = 'none';
                }
            });
        }
    });
    </script>
    
    <!-- PWA Scripts -->
    <script src="localdb.js"></script>
    <script src="sync-manager.js"></script>
    <script>
    // ========================================
    // PWA Initialization
    // ========================================

    // ุญูุงูุฉ ูู ุนุฏู ุชุญููู ุงููููุงุช ุงูุฎุงุฑุฌูุฉ
    if (typeof localDB === 'undefined') {
        window.localDB = { isReady: false, init: async()=>{}, save:async()=>{}, saveAll:async()=>{}, getAll:async()=>[], get:async()=>null, add:async()=>{}, delete:async()=>{} };
    }
    if (typeof syncManager === 'undefined') {
        window.syncManager = { sync:async()=>{}, start:()=>{}, showStatus:()=>{} };
    }

    // ุชุณุฌูู Service Worker
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('/sw.js')
                .then(reg => {
                    console.log('[PWA] Service Worker registered โ');
                    // ุฅุฐุง ุชู ุชุซุจูุช ูุณุฎุฉ ุฌุฏูุฏุฉ - ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ ุชููุงุฆูุงู
                    reg.addEventListener('updatefound', () => {
                        const newWorker = reg.installing;
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'activated') {
                                console.log('[PWA] New SW activated - reloading...');
                                location.reload();
                            }
                        });
                    });
                })
                .catch(err => {
                    console.error('[PWA] Service Worker registration failed:', err);
                });

            // ุฅุนุงุฏุฉ ุชุญููู ููุฑูุฉ ุนูุฏ ุชุบููุฑ ุงููุชุญูู
            navigator.serviceWorker.addEventListener('controllerchange', () => {
                console.log('[PWA] Controller changed - reloading...');
                location.reload();
            });
        });
    }
    
    // ุชููุฆุฉ IndexedDB
    window.addEventListener('load', async () => {
        try {
            await localDB.init();
            console.log('[PWA] LocalDB initialized โ');
            
            // ุชุญููู ุฃููููุฉ Login ูู ุงูุฅุนุฏุงุฏุงุช (ูุจู ุชุณุฌูู ุงูุฏุฎูู)
            try {
                const response = await fetch(`${API_URL}/api/settings`);
                const data = await response.json();
                if (data.success && data.settings.login_icon) {
                    document.querySelector('.login-logo').innerHTML = `<img src="${data.settings.login_icon}" style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover;">`;
                    console.log('[App] Login icon loaded โ');
                }
            } catch (e) {
                console.log('[App] Using default login icon');
            }
            
            // ุชุญููู ุงูููุชุฌุงุช ุงููุญููุฉ ุฅุฐุง offline
            if (!navigator.onLine) {
                const localProducts = await localDB.getAll('products');
                if (localProducts.length > 0) {
                    console.log('[PWA] Loaded from local cache');
                }
            }
            
            // ุจุฏุก ุงููุฒุงููุฉ ุงูุชููุงุฆูุฉ
            if (navigator.onLine) {
                setTimeout(() => syncManager.sync(), 2000);
                syncManager.start(5); // ูู 5 ุฏูุงุฆู
            }
            

        } catch (error) {
            console.error('[PWA] Initialization error:', error);
        }
    });

    // ูุฑุงูุจุฉ ุญุงูุฉ ุงูุงุชุตุงู
    window.addEventListener('online', () => {
        console.log('[PWA] Online โ');
        syncManager.showStatus('๐ ูุชุตู - ุฌุงุฑู ุงููุฒุงููุฉ...', 'info');
        setTimeout(() => syncManager.sync(), 1000);
        // ูุฒุงููุฉ ุงูุนููุงุก ุงููุญููุธูู ูุญููุงู
        setTimeout(() => { if (typeof syncOfflineCustomers === 'function') syncOfflineCustomers(); }, 3000);
        // ุชูุนูู ุฒุฑ ุงูุฎุฑูุฌ
        _lockLogout(false);
    });

    window.addEventListener('offline', () => {
        console.log('[PWA] Offline ๐ด');
        syncManager.showStatus('๐ด ุบูุฑ ูุชุตู - ุงููุถุน ุงููุญูู', 'info');
        // ุชุนุทูู ุฒุฑ ุงูุฎุฑูุฌ ููุฑุงู
        _lockLogout(true);
    });

    </script>
    
    <!-- Variant Selection Modal for POS -->
    <div class="modal" id="variantSelectModal">
        <div class="modal-content" style="max-width: 450px;">
            <div class="modal-header">
                <h2 id="variantSelectTitle">๐ ุงุฎุชุฑ ุงูุฎุงุตูุฉ</h2>
                <button class="close-btn" onclick="closeVariantSelect()">โ๏ธ</button>
            </div>
            <div class="modal-body">
                <div id="variantSelectProductName" style="text-align: center; font-weight: bold; font-size: 18px; margin-bottom: 15px; color: #2d3748;"></div>
                <div id="variantSelectOptions" style="display: flex; flex-direction: column; gap: 10px;"></div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
    <script src="products-search.js"></script>
</body>
</html>
